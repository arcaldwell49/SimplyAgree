<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Deming Regression • SimplyAgree</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Deming Regression">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SimplyAgree</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/agree_tests.html">Agreement Tests</a></li>
    <li><a class="dropdown-item" href="../articles/agreement_analysis.html">Agreement &amp; Tolerance Limits</a></li>
    <li><a class="dropdown-item" href="../articles/Deming.html">Deming Regression</a></li>
    <li><a class="dropdown-item" href="../articles/power_sample_size_vignette.html">Power Analysis and Sample Size Determination for Agreement Studies</a></li>
    <li><a class="dropdown-item" href="../articles/reanalysis.html">Re-analysis of an Agreement Study</a></li>
    <li><a class="dropdown-item" href="../articles/reliability_analysis.html">Reliability Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/arcaldwell49/SimplyAgree/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Deming Regression</h1>
                        <h4 data-toc-skip class="author">Aaron R.
Caldwell</h4>
            
            <h4 data-toc-skip class="date">Last Updated: 2026-01-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/arcaldwell49/SimplyAgree/blob/master/vignettes/Deming.Rmd" class="external-link"><code>vignettes/Deming.Rmd</code></a></small>
      <div class="d-none name"><code>Deming.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>Error-in-variables (EIV) models are useful tools to account for
measurement error in the independent variable. For studies of agreement,
this is particularly useful where there are paired measurements of the
paired measurements (X &amp; Y) of the same underlying value (e.g., two
assays of the same analyte).</p>
<p>Deming regression is one of the simplest forms of of EIV models
promoted by <a href="https://en.wikipedia.org/wiki/W._Edwards_Deming" class="external-link">W.
Edwards Deming</a><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Deming was a titan of the fields of statistics and
engineering and I would highly recommend reading some of his academic
work and books&lt;/p&gt;"><sup>1</sup></a>. The first to detail the method were <span class="citation">Adcock (<a href="#ref-adcock1878">1878</a>)</span>
followed by <span class="citation">Kummell (<a href="#ref-kummell1879">1879</a>)</span> and <span class="citation">Koopmans (<a href="#ref-koopmans1936">1936</a>)</span>.
The name comes from the popularity of Deming’s book <span class="citation">(<a href="#ref-deming1943">Deming 1943</a>)</span>, and
within the field of clinical chemistry, the procedure was simply
referred to as “Deming regression” (e.g., <span class="citation">Linnet
(<a href="#ref-linnet1990">1990</a>)</span>).</p>
</div>
<div class="section level2">
<h2 id="joint-confidence-regions">Joint Confidence Regions<a class="anchor" aria-label="anchor" href="#joint-confidence-regions"></a>
</h2>
<p>A key enhancement to the <code>dem_reg</code> function is the
addition of <strong>joint confidence regions</strong> for the slope and
intercept parameters. Traditional confidence intervals treat each
parameter separately, but in regression analysis, these parameters are
correlated.</p>
<p>Joint confidence regions account for this correlation by creating an
elliptical region in the (intercept, slope) parameter space. This
approach, promoted by <span class="citation">Sadler (<a href="#ref-sadler2010">2010</a>)</span>, provides several
advantages:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Higher Statistical Power</strong>: The ellipse typically
requires 20-50% fewer samples than traditional confidence intervals to
detect the same bias</li>
<li>
<strong>Accounts for Parameter Correlation</strong>: When the
measurement range is narrow, slope and intercept are highly negatively
correlated</li>
<li>
<strong>More Appropriate Test</strong>: Testing against a point
(e.g., slope=1, intercept=0) is naturally done with a region, not
separate intervals</li>
</ol>
<p>The power advantage is most pronounced when the ratio of maximum to
minimum X values is small (&lt; 10:1), which is common in clinical
method comparisons.</p>
</div>
<div class="section level2">
<h2 id="basic-deming-regression">Basic Deming Regression<a class="anchor" aria-label="anchor" href="#basic-deming-regression"></a>
</h2>
<div class="section level3">
<h3 id="simple-deming-regression">Simple Deming Regression<a class="anchor" aria-label="anchor" href="#simple-deming-regression"></a>
</h3>
<p>We can start by creating some fake data to work with.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://aaroncaldwell.us/SimplyAgree/">SimplyAgree</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">8.3</span>, <span class="fl">10.5</span>, <span class="fl">9</span>, <span class="fl">5.1</span>, <span class="fl">8.2</span>, <span class="fl">10.2</span>, <span class="fl">10.3</span>, <span class="fl">7.1</span>, <span class="fl">5.9</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7.9</span>, <span class="fl">8.2</span>, <span class="fl">9.6</span>, <span class="fl">9</span>, <span class="fl">6.5</span>, <span class="fl">7.3</span>, <span class="fl">10.2</span>, <span class="fl">10.6</span>, <span class="fl">6.3</span>, <span class="fl">5.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Also, we will assume, based on historical data, that the measurement
error ratio is equal to 4.</p>
<p>The data can be run through the <code>dem_reg</code> function and the
results printed. Note that the output now includes a joint confidence
region test.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dem1</span> <span class="op">=</span> <span class="fu"><a href="../reference/dem_reg.html">dem_reg</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>               y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>               data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>               error.ratio <span class="op">=</span> <span class="fl">4</span>,</span>
<span>               weighted <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">dem1</span></span>
<span><span class="co">#&gt; Deming Regression with 95% C.I.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;               coef      bias     se df lower.ci upper.ci        t p.value</span></span>
<span><span class="co">#&gt; Intercept -0.08974 -0.044938 1.7220  8  -4.0607    3.881 -0.05212  0.9597</span></span>
<span><span class="co">#&gt; Slope      1.00119  0.003529 0.1872  8   0.5696    1.433  0.00638  0.9951</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Joint Confidence Region Test (H0: slope=1, intercept=0):</span></span>
<span><span class="co">#&gt;   Mahalanobis distance: 0.1126</span></span>
<span><span class="co">#&gt;   Chi-square critical:  5.9915</span></span>
<span><span class="co">#&gt;   Identity enclosed:    Yes</span></span>
<span><span class="co">#&gt;   p-value:             0.9453</span></span></code></pre></div>
<p>The resulting regression line can then be plotted. The subtitle now
indicates whether the identity line is enclosed by the joint confidence
region.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dem1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Deming_files/figure-html/unnamed-chunk-3-1.png" class="r-plt" alt="" width="700"></p>
</div>
<div class="section level3">
<h3 id="visualizing-the-joint-confidence-region">Visualizing the Joint Confidence Region<a class="anchor" aria-label="anchor" href="#visualizing-the-joint-confidence-region"></a>
</h3>
<p>A new plotting method <code><a href="../reference/simple_eiv-methods.html">plot_joint()</a></code> allows visualization
of the confidence region in parameter space:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/simple_eiv-methods.html">plot_joint</a></span><span class="op">(</span><span class="va">dem1</span>, </span>
<span>           ideal_slope <span class="op">=</span> <span class="fl">1</span>, </span>
<span>           ideal_intercept <span class="op">=</span> <span class="fl">0</span>,</span>
<span>           show_intervals <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">SimplyAgree</span> package.</span></span>
<span><span class="co">#&gt;   Please report the issue at</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/arcaldwell49/SimplyAgree/issues&gt;</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once per session.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span></code></pre></div>
<p><img src="Deming_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" alt="" width="700"></p>
<p>This plot shows: - The <strong>red ellipse</strong>: Joint confidence
region - The <strong>blue rectangle</strong>: Traditional confidence
intervals - The <strong>black dot</strong>: Estimated (intercept, slope)
- The <strong>green/red X</strong>: Ideal point (whether enclosed or
not)</p>
<p>Notice how the ellipse is smaller than the rectangle, especially in
the directions that matter for detecting bias.</p>
</div>
<div class="section level3">
<h3 id="model-diagnostics">Model Diagnostics<a class="anchor" aria-label="anchor" href="#model-diagnostics"></a>
</h3>
<p>The assumptions of the Deming regression model, primarily normality
and homogeneity of variance, can then be checked with the
<code>check</code> method for Deming regression results. Both plots
appear to be fine with regards to the assumptions.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/simple_agree-methods.html">check</a></span><span class="op">(</span><span class="va">dem1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Deming_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" alt="" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="weighted-deming-regression">Weighted Deming Regression<a class="anchor" aria-label="anchor" href="#weighted-deming-regression"></a>
</h2>
<p>For this example, I will rely upon the “ferritin” data from the
<code>deming</code> R package.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">deming</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">'ferritin'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ferritin</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id period old.lot new.lot</span></span>
<span><span class="co">#&gt; 1  1      1       1       1</span></span>
<span><span class="co">#&gt; 2  2      1       3       3</span></span>
<span><span class="co">#&gt; 3  3      1      10       9</span></span>
<span><span class="co">#&gt; 4  4      1      13      11</span></span>
<span><span class="co">#&gt; 5  5      1      13      12</span></span>
<span><span class="co">#&gt; 6  6      1      15      13</span></span></code></pre></div>
<p>Let me demonstrate the problem with using simple Deming regression
when the weights are helpful. When we look at the two plots below, we
can see there is severe problem with using the “un-weighted” model.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dem2</span> <span class="op">=</span> <span class="fu"><a href="../reference/dem_reg.html">dem_reg</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="st">"new.lot"</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"old.lot"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">ferritin</span>,</span>
<span>  weighted <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dem2</span></span>
<span><span class="co">#&gt; Deming Regression with 95% C.I.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             coef      bias      se  df lower.ci upper.ci      t p.value</span></span>
<span><span class="co">#&gt; Intercept 5.2157 -0.235818 2.18603 160   0.8985    9.533  2.386 0.01821</span></span>
<span><span class="co">#&gt; Slope     0.9637  0.002597 0.02505 160   0.9143    1.013 -1.448 0.14949</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Joint Confidence Region Test (H0: slope=1, intercept=0):</span></span>
<span><span class="co">#&gt;   Mahalanobis distance: 11.1908</span></span>
<span><span class="co">#&gt;   Chi-square critical:  5.9915</span></span>
<span><span class="co">#&gt;   Identity enclosed:    No</span></span>
<span><span class="co">#&gt;   p-value:             0.0037</span></span>
<span></span>
<span><span class="fu"><a href="../reference/simple_agree-methods.html">check</a></span><span class="op">(</span><span class="va">dem2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Deming_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" alt="" width="700"></p>
<p>Now, let us see what happens when <code>weighted</code> is set to
TRUE.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dem3</span> <span class="op">=</span> <span class="fu"><a href="../reference/dem_reg.html">dem_reg</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="st">"new.lot"</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"old.lot"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">ferritin</span>,</span>
<span>  weighted <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dem3</span></span>
<span><span class="co">#&gt; Weighted Deming Regression with 95% C.I.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;               coef       bias       se  df lower.ci upper.ci       t   p.value</span></span>
<span><span class="co">#&gt; Intercept -0.02616  0.0065148 0.033219 160 -0.09176  0.03945 -0.7874 4.322e-01</span></span>
<span><span class="co">#&gt; Slope      1.03052 -0.0001929 0.006262 160  1.01815  1.04288  4.8729 2.626e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Joint Confidence Region Test (H0: slope=1, intercept=0):</span></span>
<span><span class="co">#&gt;   Mahalanobis distance: 23.7841</span></span>
<span><span class="co">#&gt;   Chi-square critical:  5.9915</span></span>
<span><span class="co">#&gt;   Identity enclosed:    No</span></span>
<span><span class="co">#&gt;   p-value:             0.0000</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dem3</span><span class="op">)</span></span></code></pre></div>
<p><img src="Deming_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/simple_agree-methods.html">check</a></span><span class="op">(</span><span class="va">dem3</span><span class="op">)</span></span></code></pre></div>
<p><img src="Deming_files/figure-html/unnamed-chunk-8-2.png" class="r-plt" alt="" width="700"></p>
<p>Notice the joint confidence region test now shows different results.
The weighted model provides a better fit.</p>
</div>
<div class="section level2">
<h2 id="power-analysis-and-sample-size-determination">Power Analysis and Sample Size Determination<a class="anchor" aria-label="anchor" href="#power-analysis-and-sample-size-determination"></a>
</h2>
<div class="section level3">
<h3 id="understanding-power-in-method-comparisons">Understanding Power in Method Comparisons<a class="anchor" aria-label="anchor" href="#understanding-power-in-method-comparisons"></a>
</h3>
<p>Before conducting a method comparison study, it’s crucial to
determine the appropriate sample size. The
<code><a href="../reference/deming_power.html">deming_power_sim()</a></code> function estimates statistical power for
detecting specified biases.</p>
<div class="section level4">
<h4 id="simple-power-analysis">Simple Power Analysis<a class="anchor" aria-label="anchor" href="#simple-power-analysis"></a>
</h4>
<p>Let’s determine the power to detect 5% proportional bias with
N=50:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define error characteristics (from validation studies)</span></span>
<span><span class="va">y_errors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta1 <span class="op">=</span> <span class="fl">0.5</span>, beta2 <span class="op">=</span> <span class="fl">0.05</span>, J <span class="op">=</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">"power"</span><span class="op">)</span></span>
<span><span class="va">x_errors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta1 <span class="op">=</span> <span class="fl">0.4</span>, beta2 <span class="op">=</span> <span class="fl">0.04</span>, J <span class="op">=</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">"power"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">power_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/deming_power.html">deming_power_sim</a></span><span class="op">(</span></span>
<span>  n_sims <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  sample_size <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  x_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">200</span><span class="op">)</span>,</span>
<span>  actual_slope <span class="op">=</span> <span class="fl">1.05</span>,  <span class="co"># 5% proportional bias</span></span>
<span>  ideal_slope <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>  y_var_params <span class="op">=</span> <span class="va">y_errors</span>,</span>
<span>  x_var_params <span class="op">=</span> <span class="va">x_errors</span>,</span>
<span>  weighted <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">power_result</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Deming Regression Power Analysis ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample Size: N = 50</span></span>
<span><span class="co">#&gt; Simulations: 100</span></span>
<span><span class="co">#&gt; Confidence Level: 95%</span></span>
<span><span class="co">#&gt; Testing: slope = 1.050, intercept = 0.000</span></span>
<span><span class="co">#&gt; Against: slope = 1.000, intercept = 0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Statistical Power:</span></span>
<span><span class="co">#&gt;   Slope CI:          78.0%</span></span>
<span><span class="co">#&gt;   Intercept CI:      6.0%</span></span>
<span><span class="co">#&gt;   Either CI:         80.0%</span></span>
<span><span class="co">#&gt;   Joint Region:      98.0%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Joint Region Advantage: +18.0 percentage points</span></span></code></pre></div>
<p>The joint confidence region provides <strong>13.3 percentage points
higher power</strong> than confidence intervals!</p>
</div>
</div>
<div class="section level3">
<h3 id="automatic-sample-size-determination">Automatic Sample Size Determination<a class="anchor" aria-label="anchor" href="#automatic-sample-size-determination"></a>
</h3>
<p>The <code><a href="../reference/deming_sample_size.html">deming_sample_size()</a></code> function automatically finds
the minimum N needed:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_size_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/deming_sample_size.html">deming_sample_size</a></span><span class="op">(</span></span>
<span>  target_power <span class="op">=</span> <span class="fl">0.90</span>,  <span class="co"># Want 90% power</span></span>
<span>  initial_n <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  max_n <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  n_sims <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  x_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">200</span><span class="op">)</span>,</span>
<span>  actual_slope <span class="op">=</span> <span class="fl">1.05</span>,</span>
<span>  ideal_slope <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>  y_var_params <span class="op">=</span> <span class="va">y_errors</span>,</span>
<span>  x_var_params <span class="op">=</span> <span class="va">x_errors</span>,</span>
<span>  weighted <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Searching for N to achieve 90% power...</span></span>
<span><span class="co">#&gt;   Testing N = 30... CI: 50.0%, Joint: 86.0%</span></span>
<span><span class="co">#&gt;   Testing N = 35... CI: 60.0%, Joint: 97.0%</span></span>
<span><span class="co">#&gt;   Testing N = 40... CI: 66.0%, Joint: 96.0%</span></span>
<span><span class="co">#&gt;   Testing N = 45... CI: 70.0%, Joint: 97.0%</span></span>
<span><span class="co">#&gt;   Testing N = 50... CI: 72.0%, Joint: 98.0%</span></span>
<span><span class="co">#&gt;   Testing N = 55... CI: 82.0%, Joint: 100.0%</span></span>
<span><span class="co">#&gt;   Testing N = 60... CI: 84.0%, Joint: 100.0%</span></span>
<span><span class="co">#&gt;   Testing N = 65... CI: 90.0%, Joint: 100.0%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Target power achieved!</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sample_size_result</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Deming Regression Sample Size Determination ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Target Power: 90%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Required Sample Sizes:</span></span>
<span><span class="co">#&gt;   Confidence Intervals:  N = 65</span></span>
<span><span class="co">#&gt;   Joint Region:          N = 35</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample Size Reduction:  30 (46%)</span></span>
<span><span class="co">#&gt; You can save 30 participants using joint confidence regions!</span></span></code></pre></div>
<div class="section level4">
<h4 id="visualizing-the-power-curve">Visualizing the Power Curve<a class="anchor" aria-label="anchor" href="#visualizing-the-power-curve"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample_size_result</span><span class="op">)</span></span></code></pre></div>
<p>This creates a power curve showing how statistical power increases
with sample size for both methods.</p>
</div>
</div>
<div class="section level3">
<h3 id="practical-guidelines">Practical Guidelines<a class="anchor" aria-label="anchor" href="#practical-guidelines"></a>
</h3>
<div class="section level4">
<h4 id="when-to-use-joint-confidence-regions">When to Use Joint Confidence Regions<a class="anchor" aria-label="anchor" href="#when-to-use-joint-confidence-regions"></a>
</h4>
<p>The power advantage of joint regions is most pronounced when:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Narrow measurement ranges</strong>: max/min ratio &lt;
10:1</li>
<li>
<strong>Testing against identity</strong>: slope=1, intercept=0</li>
<li>
<strong>Clinical lab comparisons</strong>: typical measurement
ranges</li>
<li>
<strong>Limited sample availability</strong>: cost or ethical
constraints</li>
</ol>
</div>
<div class="section level4">
<h4 id="specifying-error-characteristics">Specifying Error Characteristics<a class="anchor" aria-label="anchor" href="#specifying-error-characteristics"></a>
</h4>
<p>The variance parameters should come from validation data:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># From replicate measurements at different concentrations</span></span>
<span><span class="va">concentrations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">cv_percent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8.5</span>, <span class="fl">6.2</span>, <span class="fl">5.1</span>, <span class="fl">4.8</span>, <span class="fl">5.2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit power function to estimate parameters</span></span>
<span><span class="co"># Then create variance parameters</span></span>
<span><span class="va">y_var_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  beta1 <span class="op">=</span> <span class="fl">0.5</span>,    <span class="co"># Fitted parameter</span></span>
<span>  beta2 <span class="op">=</span> <span class="fl">0.05</span>,   <span class="co"># Fitted parameter</span></span>
<span>  J <span class="op">=</span> <span class="fl">2</span>,          <span class="co"># Typically 2 for CV% pattern</span></span>
<span>  type <span class="op">=</span> <span class="st">"power"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="effect-of-measurement-range">Effect of Measurement Range<a class="anchor" aria-label="anchor" href="#effect-of-measurement-range"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Narrow range (2:1 ratio) - HIGH correlation</span></span>
<span><span class="va">narrow_power</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/deming_power.html">deming_power_sim</a></span><span class="op">(</span></span>
<span>  sample_size <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  x_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">100</span><span class="op">)</span>,  <span class="co"># Narrow range</span></span>
<span>  actual_slope <span class="op">=</span> <span class="fl">1.05</span>,</span>
<span>  y_var_params <span class="op">=</span> <span class="va">y_errors</span>,</span>
<span>  x_var_params <span class="op">=</span> <span class="va">x_errors</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Wide range (20:1 ratio) - LOW correlation  </span></span>
<span><span class="va">wide_power</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/deming_power.html">deming_power_sim</a></span><span class="op">(</span></span>
<span>  sample_size <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  x_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">200</span><span class="op">)</span>,  <span class="co"># Wide range</span></span>
<span>  actual_slope <span class="op">=</span> <span class="fl">1.05</span>,</span>
<span>  y_var_params <span class="op">=</span> <span class="va">y_errors</span>,</span>
<span>  x_var_params <span class="op">=</span> <span class="va">x_errors</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare advantages</span></span>
<span><span class="va">narrow_power</span><span class="op">$</span><span class="va">advantage</span>  </span>
<span><span class="co">#&gt; [1] 0.85</span></span>
<span><span class="va">wide_power</span><span class="op">$</span><span class="va">advantage</span>   </span>
<span><span class="co">#&gt; [1] 0.425</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="complete-workflow-example">Complete Workflow Example<a class="anchor" aria-label="anchor" href="#complete-workflow-example"></a>
</h3>
<p>Here’s a complete workflow for planning a method comparison
study:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Step 1: Define study parameters from prior knowledge</span></span>
<span><span class="va">x_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">200</span><span class="op">)</span>  <span class="co"># Analyte measurement range</span></span>
<span><span class="va">bias_to_detect</span> <span class="op">&lt;-</span> <span class="fl">1.03</span>  <span class="co"># Want to detect 3% bias</span></span>
<span></span>
<span><span class="co"># Error profiles from validation studies</span></span>
<span><span class="va">y_errors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta1 <span class="op">=</span> <span class="fl">0.5</span>, beta2 <span class="op">=</span> <span class="fl">0.05</span>, J <span class="op">=</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">"power"</span><span class="op">)</span></span>
<span><span class="va">x_errors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta1 <span class="op">=</span> <span class="fl">0.4</span>, beta2 <span class="op">=</span> <span class="fl">0.04</span>, J <span class="op">=</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">"power"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 2: Determine required sample size</span></span>
<span><span class="va">sample_plan</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/deming_sample_size.html">deming_sample_size</a></span><span class="op">(</span></span>
<span>  target_power <span class="op">=</span> <span class="fl">0.90</span>,</span>
<span>  initial_n <span class="op">=</span> <span class="fl">65</span>,</span>
<span>  max_n <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  n_sims <span class="op">=</span> <span class="fl">100</span>,  <span class="co"># Use 1000+ for final determination</span></span>
<span>  x_range <span class="op">=</span> <span class="va">x_range</span>,</span>
<span>  actual_slope <span class="op">=</span> <span class="va">bias_to_detect</span>,</span>
<span>  ideal_slope <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>  y_var_params <span class="op">=</span> <span class="va">y_errors</span>,</span>
<span>  x_var_params <span class="op">=</span> <span class="va">x_errors</span>,</span>
<span>  weighted <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Searching for N to achieve 90% power...</span></span>
<span><span class="co">#&gt;   Testing N = 65... CI: 47.0%, Joint: 83.0%</span></span>
<span><span class="co">#&gt;   Testing N = 70... CI: 58.0%, Joint: 87.0%</span></span>
<span><span class="co">#&gt;   Testing N = 75... CI: 56.0%, Joint: 89.0%</span></span>
<span><span class="co">#&gt;   Testing N = 80... CI: 52.0%, Joint: 91.0%</span></span>
<span><span class="co">#&gt;   Testing N = 85... CI: 63.0%, Joint: 92.0%</span></span>
<span><span class="co">#&gt;   Testing N = 90... CI: 51.0%, Joint: 93.0%</span></span>
<span><span class="co">#&gt;   Testing N = 95... CI: 62.0%, Joint: 97.0%</span></span>
<span><span class="co">#&gt;   Testing N = 100... CI: 62.0%, Joint: 95.0%</span></span>
<span><span class="co">#&gt;   Testing N = 105... CI: 66.0%, Joint: 96.0%</span></span>
<span><span class="co">#&gt;   Testing N = 110... CI: 66.0%, Joint: 99.0%</span></span>
<span><span class="co">#&gt;   Testing N = 115... CI: 71.0%, Joint: 97.0%</span></span>
<span><span class="co">#&gt;   Testing N = 120... CI: 68.0%, Joint: 98.0%</span></span>
<span><span class="co">#&gt;   Testing N = 125... CI: 78.0%, Joint: 99.0%</span></span>
<span><span class="co">#&gt;   Testing N = 130... CI: 79.0%, Joint: 99.0%</span></span>
<span><span class="co">#&gt;   Testing N = 135... CI: 75.0%, Joint: 99.0%</span></span>
<span><span class="co">#&gt;   Testing N = 140... CI: 78.0%, Joint: 100.0%</span></span>
<span><span class="co">#&gt;   Testing N = 145... CI: 85.0%, Joint: 100.0%</span></span>
<span><span class="co">#&gt;   Testing N = 150... CI: 84.0%, Joint: 100.0%</span></span>
<span><span class="co">#&gt;   Testing N = 155... CI: 83.0%, Joint: 100.0%</span></span>
<span><span class="co">#&gt;   Testing N = 160... CI: 83.0%, Joint: 100.0%</span></span>
<span><span class="co">#&gt;   Testing N = 165... CI: 83.0%, Joint: 100.0%</span></span>
<span><span class="co">#&gt;   Testing N = 170... CI: 92.0%, Joint: 100.0%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Target power achieved!</span></span>
<span></span>
<span><span class="co"># Step 3: Review results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sample_plan</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Deming Regression Sample Size Determination ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Target Power: 90%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Required Sample Sizes:</span></span>
<span><span class="co">#&gt;   Confidence Intervals:  N = 170</span></span>
<span><span class="co">#&gt;   Joint Region:          N = 80</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample Size Reduction:  90 (53%)</span></span>
<span><span class="co">#&gt; You can save 90 participants using joint confidence regions!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample_plan</span><span class="op">)</span></span></code></pre></div>
<p><img src="Deming_files/figure-html/unnamed-chunk-14-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Step 4: Collect data with recommended N</span></span>
<span><span class="va">recommended_n</span> <span class="op">&lt;-</span> <span class="va">sample_plan</span><span class="op">$</span><span class="va">n_required_joint</span></span>
<span></span>
<span><span class="co"># Step 5: After data collection, analyze with dem_reg()</span></span>
<span><span class="co"># final_results &lt;- dem_reg(x = "method_x", y = "method_y", </span></span>
<span><span class="co">#                          data = my_data, weighted = TRUE)</span></span>
<span><span class="co"># plot_joint(final_results)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="theoretical-details">Theoretical Details<a class="anchor" aria-label="anchor" href="#theoretical-details"></a>
</h2>
<div class="section level3">
<h3 id="calculative-approach">Calculative Approach<a class="anchor" aria-label="anchor" href="#calculative-approach"></a>
</h3>
<p>Deming regression assumes paired measures (<span class="math inline">\(x_i, \space  y_i\)</span>) are each measured with
error.</p>
<p><span class="math display">\[
x_i = X_i + \epsilon_i
\]</span></p>
<p><span class="math display">\[
y_i = Y_i + \delta_i
\]</span></p>
<p>We can then measure the relationship between the two variables with
the following model.</p>
<p><span class="math display">\[
\hat Y_i = \beta_0 + \beta_1 \cdot \hat X_i
\]</span></p>
<p>Traditionally there are 2 null hypotheses</p>
<p>First, the intercept is equal to zero</p>
<p><span class="math display">\[
H_0: \beta_0 = 0 \space vs. \space H_1: \beta_0 \ne 0
\]</span></p>
<p>Second, that the slope is equal to one.</p>
<p><span class="math display">\[
H_0: \beta_1 = 1 \space vs. \space H_1: \beta_0 \ne 1
\]</span></p>
</div>
<div class="section level3">
<h3 id="joint-confidence-region">Joint Confidence Region<a class="anchor" aria-label="anchor" href="#joint-confidence-region"></a>
</h3>
<p>The joint <span class="math inline">\((1-\alpha) \times
100\%\)</span> confidence region for <span class="math inline">\((\beta_0, \beta_1)\)</span> is defined as:</p>
<p><span class="math display">\[
(\hat{\beta} - \beta_0)^T V^{-1} (\hat{\beta} - \beta_0) \leq
\chi^2_{2,\alpha}
\]</span></p>
<p>Where:</p>
<ul>
<li>
<span class="math inline">\(\hat{\beta}\)</span> = estimated
parameters <span class="math inline">\((\hat{\beta}_0,
\hat{\beta}_1)\)</span>
</li>
<li>
<span class="math inline">\(\beta_0\)</span> = hypothesized
parameters (e.g., <span class="math inline">\((0, 1)\)</span> for
identity)</li>
<li>
<span class="math inline">\(V\)</span> = variance-covariance
matrix</li>
<li>
<span class="math inline">\(\chi^2_{2,\alpha}\)</span> = chi-square
critical value with 2 degrees of freedom</li>
</ul>
<p>This forms an ellipse in parameter space that accounts for the
correlation between slope and intercept.</p>
</div>
<div class="section level3">
<h3 id="measurement-error">Measurement Error<a class="anchor" aria-label="anchor" href="#measurement-error"></a>
</h3>
<p>A Deming regression model also assumes the measurement error (<span class="math inline">\(\sigma^2\)</span>) ratio is constant.</p>
<p><span class="math display">\[
\lambda = \frac{\sigma^2_\epsilon}{\sigma^2_\delta}
\]</span></p>
<p>In <code>SimplyAgree</code>, the error ratio can be set with the
<code>error.ratio</code> argument. It defaults to 1, but can be changed
by the user. If replicate measures are taken, then the user can use the
<code>id</code> argument to indicate which measures belong to which
subject/participant. The measurement error, and the error ratio, will
then be estimated from the data itself.</p>
<p>If the data was not measured in replicate then the error ratio (<span class="math inline">\(\lambda\)</span>) can be estimated from the
coefficient of variation (if that data is available) and the mean of x
and y (<span class="math inline">\(\bar x, \space \bar y\)</span>).</p>
<p><span class="math display">\[
\lambda = \frac{(CV_y \cdot \bar y)^2}{(CV_x \cdot \bar x)^2}
\]</span></p>
</div>
<div class="section level3">
<h3 id="weights">Weights<a class="anchor" aria-label="anchor" href="#weights"></a>
</h3>
<p>In some cases the variance of X and Y may increase proportional to
the true value of the measure. In these cases, it may be prudent to use
“weighted” Deming regression models. The weights used in
<code>SimplyAgree</code> are the same as those suggested by <span class="citation">Linnet (<a href="#ref-linnet1993">1993</a>)</span>.</p>
<p><span class="math display">\[
\hat w_i = \frac{1}{ [ \frac{x_i + \lambda \cdot y_i}{1 + \lambda}]^2}
\]</span></p>
<p>Weights can also be provided through the <code>weights</code>
argument. If weighted Deming regression is not selected
(<code>weighted = FALSE</code>), the weights for each observation is
equal to 1.</p>
<p>The estimated mean of X and Y are then estimated as the
following.</p>
<p><span class="math display">\[
\bar x_w =  \frac{\Sigma^{N}_{i=1} \hat w_i \cdot x_i}{\Sigma^{N}_{i=1}
\hat w_i}
\]</span></p>
<p><span class="math display">\[
\bar y_w =  \frac{\Sigma^{N}_{i=1} \hat w_i \cdot y_i}{\Sigma^{N}_{i=1}
\hat w_i}
\]</span></p>
</div>
<div class="section level3">
<h3 id="estimating-the-slope-and-intercept">Estimating the Slope and Intercept<a class="anchor" aria-label="anchor" href="#estimating-the-slope-and-intercept"></a>
</h3>
<p>First, there are 3 components (<span class="math inline">\(v_x,
\space v_y, \space cov_{xy}\)</span>)</p>
<p><span class="math display">\[
v_x = \Sigma_{i=1}^N \space \hat w_i \cdot (x_i- \bar x_w)^2
\]</span> <span class="math display">\[
v_y = \Sigma_{i=1}^N \space \hat w_i \cdot (y_i- \bar y_w)^2
\]</span> <span class="math display">\[
cov_{xy} = \Sigma_{i=1}^N \space \hat w_i \cdot  (x_i- \bar x_w) \cdot
(y_i- \bar y_w)
\]</span></p>
<p>The slope (<span class="math inline">\(b_1\)</span>) can then be
estimated with the following equation.</p>
<p><span class="math display">\[
b_1 = \frac{(\lambda \cdot v_y - v_x) + \sqrt{(v_x-\lambda \cdot v_y)^2
+ 4 \cdot \lambda \cdot cov_{xy}^2}}{2 \cdot \lambda \cdot cov_{xy}}
\]</span></p>
<p>The intercept (<span class="math inline">\(b_0\)</span>) can then be
estimated with the following equation.</p>
<p><span class="math display">\[
b_0 = \bar y_w - b_1 \cdot \bar x_w
\]</span></p>
<p>The standard errors of b1 and b0 are both estimated using a jackknife
method (detailed by <span class="citation">Linnet (<a href="#ref-linnet1990">1990</a>)</span>).</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-adcock1878" class="csl-entry">
Adcock, R J. 1878. <span>“A Problem in Least Squares.”</span> <em>The
Analyst</em> 5 (2): 53. <a href="https://doi.org/10.2307/2635758" class="external-link">https://doi.org/10.2307/2635758</a>.
</div>
<div id="ref-deming1943" class="csl-entry">
Deming, W E. 1943. <em>Statistical Adjustment of Data</em>. Wiley.
</div>
<div id="ref-koopmans1936" class="csl-entry">
Koopmans, Tjalling Charles. 1936. <em>Linear Regression Analysis of
Economic Time Series</em>. Vol. 20. DeErven F. Bohn, Haarlem,
Netherlands.
</div>
<div id="ref-kummell1879" class="csl-entry">
Kummell, C H. 1879. <span>“Reduction of Observation Equations Which
Contain More Than One Observed Quantity.”</span> <em>The Analyst</em> 6
(4): 97. <a href="https://doi.org/10.2307/2635646" class="external-link">https://doi.org/10.2307/2635646</a>.
</div>
<div id="ref-linnet1990" class="csl-entry">
Linnet, Kristian. 1990. <span>“Estimation of the Linear Relationship
Between the Measurements of Two Methods with Proportional
Errors.”</span> <em>Statistics in Medicine</em> 9 (12): 1463–73. <a href="https://doi.org/10.1002/sim.4780091210" class="external-link">https://doi.org/10.1002/sim.4780091210</a>.
</div>
<div id="ref-linnet1993" class="csl-entry">
———. 1993. <span>“Evaluation of Regression Procedures for Methods
Comparison Studies.”</span> <em>Clinical Chemistry</em> 39 (3): 424–32.
</div>
<div id="ref-sadler2010" class="csl-entry">
Sadler, W A. 2010. <span>“Joint Parameter Confidence Regions Improve the
Power of Parametric Regression in Method-Comparison Studies.”</span>
<em>Accreditation Qual. Assur.</em> 15 (10): 547–54.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aaron Caldwell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
