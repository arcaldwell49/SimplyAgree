<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reliability Analysis • SimplyAgree</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Reliability Analysis">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SimplyAgree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/agree_tests.html">Agreement Tests</a>
    </li>
    <li>
      <a href="../articles/agreement_analysis.html">Agreement &amp; Tolerance Limits</a>
    </li>
    <li>
      <a href="../articles/Deming.html">Deming Regression</a>
    </li>
    <li>
      <a href="../articles/reanalysis.html">Re-analysis of an Agreement Study</a>
    </li>
    <li>
      <a href="../articles/reliability_analysis.html">Reliability Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/arcaldwell49/SimplyAgree/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Reliability Analysis</h1>
                        <h4 data-toc-skip class="author">Aaron R.
Caldwell</h4>
            
            <h4 data-toc-skip class="date">Last Updated: 2025-09-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/arcaldwell49/SimplyAgree/blob/master/vignettes/reliability_analysis.Rmd" class="external-link"><code>vignettes/reliability_analysis.Rmd</code></a></small>
      <div class="hidden name"><code>reliability_analysis.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>Another feature of this R package is the ability to estimate the
reliability of a measurement. This R package allows for the calculation
of Intraclass Correlation Coefficients (ICC), various standard errors
(SEM, SEE, and SEP), and coefficient of variation. All of the underlying
calculations (sans the coefficient of variation) are based on the paper
by <span class="citation">Weir (<a href="#ref-weir2005">2005</a>)</span><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. This is a fairly popular paper within my
own field (kinesiology), and hence was the inspiration for creating this
function that provides all the calculative approaches included within
that manuscript.</p>
</div>
<div class="section level2">
<h2 id="code-demonstration">Code Demonstration<a class="anchor" aria-label="anchor" href="#code-demonstration"></a>
</h2>
<p>For this package, the test-retest reliability statistics can be
calculated with the <code>reli_stats</code> function. This function
allow for data to be input in a long (multiple rows of data for each
subject) or in wide (one row for each subject but a column for each
item/measure).</p>
<p>For the long data form, the column containing the subject identifier
(<code>id</code>), item number (<code>item</code>), and measurements
(<code>measure</code>) are provided. In this function I refer to items
similar to if we were measuring internal consistency for a questionnaire
(which is just a special case of test-retest reliability). So,
<code>item</code> could also be refer to time points, which is what is
typically seen in human performance settings where test-retest
reliability may be evaluated over the course of repeated visits to the
same laboratory. If <code>wide</code> is set to <code>TRUE</code> then
the columns containing the measurements are provided (e.g.,
<code>c("value1","value2","value3")</code>).</p>
<p>To demonstrate the function, I will create a data set in the wide
format.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span>  <span class="co"># Example from Shrout and Fleiss (1979), pg. 423</span></span>
<span>  <span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>judge1 <span class="op">=</span> </span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>,<span class="fl">6</span>,<span class="fl">8</span>,<span class="fl">7</span>,<span class="fl">10</span>,<span class="fl">6</span><span class="op">)</span>,</span>
<span>                   judge2 <span class="op">=</span> </span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                   judge3 <span class="op">=</span> </span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">2</span>,<span class="fl">6</span>,<span class="fl">4</span><span class="op">)</span>,</span>
<span>                   judge4 <span class="op">=</span> </span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">2</span>,<span class="fl">8</span>,<span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now, that we have a data set (<code>dat</code>), I can use it in the
<code>reli_stats</code> function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test1</span> <span class="op">=</span> <span class="fu"><a href="../reference/reli_stats.html">reli_stats</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>  wide <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"judge1"</span>, <span class="st">"judge2"</span>, <span class="st">"judge3"</span>, <span class="st">"judge4"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This function also has generic print and plot functions. The output
from print provides the coefficient of variation, standard errors, and a
table of various intraclass correlation coefficients. Notice the
conclusions about the reliability of the measurement here would vary
greatly based on the statistic being reported. What statistic you should
report is beyond the current vignette, but is heavily detailed in <span class="citation">Weir (<a href="#ref-weir2005">2005</a>)</span>.
However, within the table there are columns for <code>model</code> and
<code>measures</code> which describe the model that is being used and
the what these different ICCs are intended to measure, respectively.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">test1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficient of Variation (%):  19.1</span></span>
<span><span class="co">#&gt; Standard Error of Measurement (SEM):  1.01</span></span>
<span><span class="co">#&gt; Standard Error of the Estimate (SEE):  1.22</span></span>
<span><span class="co">#&gt; Standard Error of Prediction (SEP):  1.9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intraclass Correlation Coefficients with  95 % C.I.</span></span>
<span><span class="co">#&gt;            Model         Measures  Type    ICC Lower CI Upper CI</span></span>
<span><span class="co">#&gt; 1 one-way random        Agreement  ICC1 0.1657 -0.09672   0.6434</span></span>
<span><span class="co">#&gt; 2 two-way random        Agreement  ICC2 0.2898  0.04290   0.6911</span></span>
<span><span class="co">#&gt; 3  two-way fixed      Consistency  ICC3 0.7148  0.41184   0.9258</span></span>
<span><span class="co">#&gt; 4 one-way random   Avg. Agreement ICC1k 0.4428 -0.54504   0.8783</span></span>
<span><span class="co">#&gt; 5 two-way random   Avg. Agreement ICC2k 0.6201  0.15204   0.8995</span></span>
<span><span class="co">#&gt; 6  two-way fixed Avg. Consistency ICC3k 0.9093  0.73690   0.9804</span></span></code></pre></div>
<p>Also included in the results is a plot of the measurements across the
items (e.g., time points).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test1</span><span class="op">)</span></span></code></pre></div>
<p><img src="reliability_analysis_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="convergence-issues">Convergence Issues<a class="anchor" aria-label="anchor" href="#convergence-issues"></a>
</h2>
<p>In some cases there are convergence issues for the linear mixed
models. For this reason, I have added a function, <code>reli_aov</code>,
which uses a sums of squares approach (i.e., analysis of variance)
rather than a linear mixed model. As you can see below the results will
often match that of <code>reli_stats</code>. The only time this function
is necessary to use is when there are convergence issues. Rows with
missing data are dropped when using <code>reli_aov</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test2</span> <span class="op">=</span> <span class="fu"><a href="../reference/reli_stats.html">reli_aov</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>  wide <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"judge1"</span>, <span class="st">"judge2"</span>, <span class="st">"judge3"</span>, <span class="st">"judge4"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">test2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficient of Variation (%):  19.1</span></span>
<span><span class="co">#&gt; Standard Error of Measurement (SEM):  1.01</span></span>
<span><span class="co">#&gt; Standard Error of the Estimate (SEE):  1.22</span></span>
<span><span class="co">#&gt; Standard Error of Prediction (SEP):  1.9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intraclass Correlation Coefficients with  95 % C.I.</span></span>
<span><span class="co">#&gt;            Model         Measures  Type    ICC Lower CI Upper CI</span></span>
<span><span class="co">#&gt; 1 one-way random        Agreement  ICC1 0.1657 -0.09672   0.6434</span></span>
<span><span class="co">#&gt; 2 two-way random        Agreement  ICC2 0.2898  0.04290   0.6911</span></span>
<span><span class="co">#&gt; 3  two-way fixed      Consistency  ICC3 0.7148  0.41183   0.9258</span></span>
<span><span class="co">#&gt; 4 one-way random   Avg. Agreement ICC1k 0.4428 -0.54504   0.8783</span></span>
<span><span class="co">#&gt; 5 two-way random   Avg. Agreement ICC2k 0.6201  0.15204   0.8995</span></span>
<span><span class="co">#&gt; 6  two-way fixed Avg. Consistency ICC3k 0.9093  0.73690   0.9804</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="calculative-approach">Calculative Approach<a class="anchor" aria-label="anchor" href="#calculative-approach"></a>
</h2>
<div class="section level3">
<h3 id="model">Model<a class="anchor" aria-label="anchor" href="#model"></a>
</h3>
<p>The linear mixed model used for the calculations is specified as the
following:</p>
<p><span class="math display">\[
  Y_{i} \sim\ N \left(\alpha_{j[i],k[i]}, \sigma^2 \right)
\]</span></p>
<p><span class="math display">\[
    \alpha_{j}  \sim\ N \left(\mu_{\alpha_{j}}, \sigma^2_{\alpha_{j}}
\right)
    \text{, for id j = 1,} \dots \text{,J}
\]</span></p>
<p><span class="math display">\[
    \alpha_{k}  \sim\ N \left(\mu_{\alpha_{k}}, \sigma^2_{\alpha_{k}}
\right)
    \text{, for items k = 1,} \dots \text{,K}
\]</span></p>
</div>
<div class="section level3">
<h3 id="components-of-variance">Components of Variance<a class="anchor" aria-label="anchor" href="#components-of-variance"></a>
</h3>
<p><strong>Mean Squared Error (MSE)</strong></p>
<p><span class="math display">\[
MSE = \sigma^2
\]</span></p>
<p><strong>Variance Between Subjects</strong></p>
<p><span class="math display">\[
MSB = n_k \cdot \sigma^2_{\alpha j} + \sigma^2
\]</span></p>
<p><strong>Variance Between Items/Judges</strong></p>
<p><span class="math display">\[
MSJ = n_{j} \cdot \sigma^2_{\alpha_{k}} + \sigma^2
\]</span></p>
<p><strong>Variance Within Subjects/Participants</strong></p>
<p><span class="math display">\[
MSW = \sigma^2 + \sigma^2_{\alpha_{k}}
\]</span></p>
</div>
<div class="section level3">
<h3 id="intraclass-correlation-coefficients">Intraclass Correlation Coefficients<a class="anchor" aria-label="anchor" href="#intraclass-correlation-coefficients"></a>
</h3>
<p><span class="math display">\[
ICC_{(1,1)} = \frac{MSB - MSW}{MSB + (n_j-1) \cdot MSW}
\]</span> <span class="math display">\[
ICC_{(2,1)} = \frac{MSB - MSE}{MSB+(n_j -1) \cdot MSE + n_j \cdot (MSJ -
MSE) \cdot n^{-1}}
\]</span> <span class="math display">\[
ICC(_{3,1)} = \frac{MSB - MSE}{MSB + (n_j -1) \cdot MSE}
\]</span> <span class="math display">\[
ICC_{(1,k)} = \frac{MSB - MSW}{MSB}
\]</span> <span class="math display">\[
ICC_{(2,k)} = \frac{MSB - MSW}{MSB + (MSJ - MSE) \cdot n_j^{-1}}
\]</span> <span class="math display">\[
ICC_{(3,k)} = \frac{MSB - MSE}{MSB}
\]</span></p>
</div>
<div class="section level3">
<h3 id="icc-confidence-intervals">ICC Confidence Intervals<a class="anchor" aria-label="anchor" href="#icc-confidence-intervals"></a>
</h3>
<div class="section level4">
<h4 id="icc11">ICC(1,1)<a class="anchor" aria-label="anchor" href="#icc11"></a>
</h4>
<p><span class="math display">\[
F =  \frac{MSB}{MSW}
\]</span></p>
<p><span class="math display">\[
df_{n} = n_j - 1
\]</span></p>
<p><span class="math display">\[
df_{d} = n_j \cdot (n_k - 1)
\]</span></p>
<p><span class="math display">\[
F_{L} = \frac{F}{F_{(1 - \alpha, \space df_{n}, \space df_{d})}}
\]</span></p>
<p><span class="math display">\[
F_{U} = F \cdot F_{(1 - \alpha, \space df_{d}, \space df_{n})}
\]</span></p>
<p><span class="math display">\[
Lower \space CI = \frac{(F_L - 1)}{(F_L + (n_j - 1))}
\]</span></p>
<p><span class="math display">\[
Upper \space CI = \frac{(F_U - 1)}{(F_U + n_j - 1)}
\]</span></p>
</div>
<div class="section level4">
<h4 id="icc21">ICC(2,1)<a class="anchor" aria-label="anchor" href="#icc21"></a>
</h4>
<p><span class="math display">\[
F =  \frac{MSJ}{MSE}
\]</span></p>
<p><span class="math display">\[
vn = (n_k - 1) \cdot (n_j - 1) \cdot [(nj \cdot ICC_{(2,1)} \cdot F +
n_j \cdot
                                     (1 + (n_k - 1) \cdot ICC_{(2,1)}) -
n_k \cdot ICC_{(2,1)})]^2
\]</span></p>
<p><span class="math display">\[
  vd = (n_j - 1) \cdot n_k^2 \cdot ICC_{(2,1)}^2 \cdot F^2 + (n_j \cdot
(1 +
                                                         (n_k - 1) \cdot
ICC_{(2,1)}) - n_k \cdot ICC_{(2,1)})^2
\]</span> <span class="math display">\[
  v = \frac{vn}{vd}
\]</span></p>
<p><span class="math display">\[
  F_{L} = F_{(1 - \alpha, \space n_j-1, \space v)}
\]</span></p>
<p><span class="math display">\[
  F_{U} = F_{(1 - \alpha, \space v, \space n_j - 1)}
\]</span></p>
<p><span class="math display">\[
  Lower \space CI = \frac{n_j \cdot (MSB - F_U \cdot MSE)}{(F_U \cdot
(n_k \cdot MSJ + (n_k \cdot n_j - n_k - n_j) \cdot MSE) + n_j \cdot
MSB)}
\]</span></p>
<p><span class="math display">\[
  Upper \space CI = \frac{n_j \cdot (MSB \cdot F_L - MSE)}{(n_k \cdot
MSJ + (n_k \cdot n_j - n_k - n_j) \cdot MSE + n_j \cdot F_L \cdot MSB)}
\]</span></p>
</div>
<div class="section level4">
<h4 id="icc31">ICC(3,1)<a class="anchor" aria-label="anchor" href="#icc31"></a>
</h4>
<p><span class="math display">\[
F =  \frac{MSJ}{MSE}
\]</span> <span class="math display">\[
df_{n} = n_j - 1
\]</span> <span class="math display">\[
df_{d} = (n_j-1) \cdot (n_k - 1)
\]</span></p>
<p><span class="math display">\[
F_{L} = \frac{F}{F_{(1 - \alpha, \space df_{n}, \space df_{d})}}
\]</span> <span class="math display">\[
F_{U} = F \cdot F_{(1 - \alpha, \space df_{n}, \space df_{d})}
\]</span> <span class="math display">\[
F3L &lt;- F31/qf(1 - alpha, df21n, df21d)
\]</span> <span class="math display">\[
F3U &lt;- F31 * qf(1 - alpha, df21d, df21n)
\]</span> <span class="math display">\[
Lower \space CI = (F3L - 1)/(F3L + n_k - 1)
\]</span></p>
<p><span class="math display">\[
Upper \space CI = (F3U - 1)/(F3U + n_k - 1)
\]</span></p>
</div>
<div class="section level4">
<h4 id="icc1k">ICC(1,k)<a class="anchor" aria-label="anchor" href="#icc1k"></a>
</h4>
<p><span class="math display">\[
F =  \frac{MSB - MSW}{MSB}
\]</span> <span class="math display">\[
df_{n} = n_j - 1
\]</span></p>
<p><span class="math display">\[
df_{d} = n_j \cdot (n_k - 1)
\]</span></p>
<p><span class="math display">\[
F_{L} = \frac{F}{F_{(1 - \alpha, \space df_{n}, \space df_{d})}}
\]</span> <span class="math display">\[
F_{U} = F \cdot F_{(1 - \alpha, \space df_{d}, \space df_{n})}
\]</span></p>
<p><span class="math display">\[
Lower \space CI = 1-\frac{1}{F_L}
\]</span> <span class="math display">\[
Upper \space CI = 1-\frac{1}{F_U}
\]</span></p>
</div>
<div class="section level4">
<h4 id="icc2k">ICC(2,k)<a class="anchor" aria-label="anchor" href="#icc2k"></a>
</h4>
<p><span class="math display">\[
F =  \frac{MSB - MSW}{MSB}
\]</span></p>
<p><span class="math display">\[
vn = (n_k - 1) \cdot (n_j - 1) \cdot [(nj \cdot ICC_{(2,k)} \cdot F +
n_j \cdot
                                     (1 + (n_k - 1) \cdot ICC_{(2,k)}) -
n_k \cdot ICC_{(2,k)})]^2
\]</span></p>
<p><span class="math display">\[
  vd = (n_j - 1) \cdot n_k^2 \cdot ICC_{(2,k)}^2 \cdot F^2 + (n_j \cdot
(1 +
                                                         (n_k - 1) \cdot
ICC_{(2,k)}) - n_k \cdot ICC_{(2,k)})^2
\]</span></p>
<p><span class="math display">\[
v = \frac{vn}{vd}
\]</span></p>
<p><span class="math display">\[
F_{L} = F_{(1 - \alpha, \space n_j-1, \space v)}
\]</span> <span class="math display">\[
F_{U} = F_{(1 - \alpha, \space v, \space n_j - 1)}
\]</span></p>
<p><span class="math display">\[
L3 = \frac{n_j \cdot (MSB - F_U \cdot MSE)}{(F_U \cdot (n_k \cdot MSJ +
(n_k \cdot n_j - n_k - n_j) \cdot MSE) + n_j \cdot MSB)}
\]</span></p>
<p><span class="math display">\[
U3 = \frac{n_j \cdot (MSB \cdot F_L - MSE)}{(n_k \cdot MSJ + (n_k \cdot
n_j - n_k - n_j) \cdot MSE + n_j \cdot F_L \cdot MSB)}
\]</span></p>
<p><span class="math display">\[
Lower \space CI = \frac{L3 \cdot n_k}{(1 + L3 \cdot (n_k - 1))}
\]</span></p>
<p><span class="math display">\[
Upper \space CI = \frac{U3 \cdot n_k}{(1 + U3 \cdot (n_k - 1))}
\]</span></p>
</div>
<div class="section level4">
<h4 id="icc3k">ICC(3,k)<a class="anchor" aria-label="anchor" href="#icc3k"></a>
</h4>
<p><span class="math display">\[
F = \frac{MSB}{MSE}
\]</span></p>
<p><span class="math display">\[
df_n = n_j - 1
\]</span></p>
<p><span class="math display">\[
df_d = (n_j - 1) \cdot (n_k - 1)
\]</span></p>
<p><span class="math display">\[
F_L = \frac{F}{F_{(1 - \alpha, \space df_n, \space df_d})}
\]</span></p>
<p><span class="math display">\[
F_U = F \cdot F_{(1 - \alpha, \space df_d, \space df_n)}
\]</span></p>
<p><span class="math display">\[
Lower \space CI = 1-\frac{1}{F_L}
\]</span></p>
<p><span class="math display">\[
Upper \space CI = 1-\frac{1}{F_U}
\]</span></p>
</div>
</div>
<div class="section level3">
<h3 id="standard-error-calculations">Standard Error Calculations<a class="anchor" aria-label="anchor" href="#standard-error-calculations"></a>
</h3>
<p>The standard error of the measurement (SEM), standard error of the
estimate (SEE), and standard error of prediction (SEP) are all estimated
with the following calculations.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<p>The default SEM calculation is the following:</p>
<p><span class="math display">\[
SEM = \sqrt{MSE}
\]</span> Alternatively, the SEM can be calculated as the following and
the ICC is determined through the <code>se_type</code> argument:</p>
<p><span class="math display">\[
SEM = \sqrt{\frac{SS_{total}}{(N-1)}} \cdot \sqrt{1-ICC}
\]</span> The other measures default to using the following equations.
The default is to use <span class="math inline">\(ICC_{3,1}\)</span>,
but can be modified with the <code>se_type</code> argument.</p>
<p><span class="math display">\[
SEE = \sqrt{\frac{SS_{total}}{(N-1)}} \cdot \sqrt{ICC \cdot (1-ICC)}
\]</span></p>
<p><span class="math display">\[
SEP = \sqrt{\frac{SS_{total}}{(N-1)}} \cdot \sqrt{1-ICC^2}
\]</span></p>
</div>
<div class="section level3">
<h3 id="coefficient-of-variation">Coefficient of Variation<a class="anchor" aria-label="anchor" href="#coefficient-of-variation"></a>
</h3>
<p>The CV is calculated 3 potential ways within <code>reli_stats</code>.
I highly recommend reporting the default version of CV.</p>
<ol style="list-style-type: decimal">
<li>From the MSE (default)</li>
</ol>
<p><span class="math display">\[
CV = \frac{ \sqrt{MSE} }{ \bar y}
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>From the SEM<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>
</li>
</ol>
<p><span class="math display">\[
CV = \frac{SEM}{ \bar y}
\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>From the model residuals (most liberal)</li>
</ol>
<p><span class="math display">\[
CV = \frac{\sqrt{\frac{\Sigma^{N}_{i=1}(y_i - \hat y_i)^2}{N_{obs}}}}{
\bar y}
\]</span></p>
</div>
<div class="section level3">
<h3 id="other-confidence-intervals">Other Confidence Intervals<a class="anchor" aria-label="anchor" href="#other-confidence-intervals"></a>
</h3>
<p>If the <code>other_ci</code> argument is set to TRUE then confidence
intervals will be calculated for the CV, SEM, SEP, and SEE.</p>
<div class="section level4">
<h4 id="chi-square">Chi-square<a class="anchor" aria-label="anchor" href="#chi-square"></a>
</h4>
<p>The default method is <code>type = 'chisq</code>. This method
utilizes the chi-square distribution to <em>approximate</em> confidence
intervals for these measurements. The accuracy of these estimates is
likely variable, and is probably poor for small samples.</p>
<p>For the CV, the calculation is as follows:</p>
<p><span class="math display">\[
Lower \space CI =
\frac{CV}{\sqrt{(\frac{\chi^2_{1-\alpha/2}}{df_{error}+1}-1) \cdot CV^2
\cdot \frac{\chi^2_{1-\alpha/2}}{df_{error}}}}
\]</span></p>
<p><span class="math display">\[
Upper \space CI =
\frac{CV}{\sqrt{(\frac{\chi^2_{\alpha/2}}{df_{error}+1}-1) \cdot CV^2
\cdot \frac{\chi^2_{\alpha/2}}{df_{error}}}}
\]</span> For the variance based measures (s) the calculation is as
follows:</p>
<p><span class="math display">\[
Lower \space CI = s \cdot \sqrt{\frac{df_{error}}{\chi^2_{1-\alpha/2}}}
\]</span></p>
<p><span class="math display">\[
Upper \space CI = s \cdot \sqrt{\frac{df_{error}}{\chi^2_{\alpha/2}}}
\]</span></p>
</div>
<div class="section level4">
<h4 id="bootstrap">Bootstrap<a class="anchor" aria-label="anchor" href="#bootstrap"></a>
</h4>
<p>If type is not set to <code>chisq</code> then bootstrapping is
performed.</p>
<ol style="list-style-type: decimal">
<li>
<code>reli_aov</code> utilizes a non-parametric ordinary
bootstrap.</li>
<li>
<code>reli_stats</code> utilizes a parametric bootstrap.</li>
</ol>
<p>The number of resamples can be set with the replicates argument
(default is 1999; increase for greater accuracy or lower for greater
speed). The reported confidence intervals are estimated using the
percentile method <code>type = 'perc'</code>, the normal
<code>type = 'norm'</code>, or basic methods
<code>type = 'basic'</code>.</p>
<p>To ensure reproducibility, please use <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> when
these confidence intervals are calculated.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="inter-rater-reliability">Inter-Rater Reliability<a class="anchor" aria-label="anchor" href="#inter-rater-reliability"></a>
</h2>
<p>In some cases, the reliability of a categorical or ordinal scale may
be worth investigating. For example, physicians may want to develop a
diagnosis tool and ensure that the diagnosis is reliable (i.e.,
categorical designation) or severity of the disease (i.e., a Likert-type
scale). Coefficients can be calculated to assess the degree of
inter-rater reliability. In its simplest form, the percent agreement
between all the raters can be calculated. All other coefficients of
agreement are essentially trying to “correct” for random guessing of the
rater. The function to make these calculations in the
<code>SimplyAgree</code> is <code>agree_coef</code>, and it produces 4
estimates: percent agreement, Gwet’s AC, Fleiss’ Kappa, and
Krippendorff’s Alpha. However, other packages provide much a much
greater breadth of calculative approaches <span class="citation">(<a href="#ref-irrCAC">Gwet 2019</a>)</span>.</p>
<p>In the <code>agree_coef</code> function, the user can specify
<code>weighted = TRUE</code>. If this argument is set to true than the
ratings have quadratic weights applied to them. Essentially, this
penalizes values farther away from each other more than those close to
each other. For example, a pair of values equal to 3 and 4 would be
penalized less than a pair of values to 1 and 4. For more details, on
these “agreement coefficients” I refer all users to Gwet’s textbook on
inter-rater agreement <span class="citation">(<a href="#ref-gwet">Gwet
2014</a>)</span>.</p>
<p>As a demonstration, we can create a matrix of ratings.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">ratermat1</span> <span class="op">=</span> <span class="op">(</span><span class="st">"Rater1 Rater2 Rater3 Rater4</span></span>
<span><span class="st">1       1      1     NA      1</span></span>
<span><span class="st">2       2      2      3      2</span></span>
<span><span class="st">3       3      3      3      3</span></span>
<span><span class="st">4       3      3      3      3</span></span>
<span><span class="st">5       2      2      2      2</span></span>
<span><span class="st">6       1      2      3      4</span></span>
<span><span class="st">7       4      4      4      4</span></span>
<span><span class="st">8       1      1      2      1</span></span>
<span><span class="st">9       2      2      2      2</span></span>
<span><span class="st">10     NA      5      5      5</span></span>
<span><span class="st">11     NA     NA      1      1</span></span>
<span><span class="st">12     NA     NA      3     NA"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">ratermat2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/textconnections.html" class="external-link">textConnection</a></span><span class="op">(</span><span class="va">ratermat1</span><span class="op">)</span>,</span>
<span>                       header<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                       row.names<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can then perform the analysis without the weights.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/agree_coef.html">agree_coef</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ratermat2</span>,</span>
<span>                     wide <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     weighted <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                     col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rater1"</span>, <span class="st">"Rater2"</span>, <span class="st">"Rater3"</span>, <span class="st">"Rater4"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                              est        se  lower.ci upper.ci</span></span>
<span><span class="co">#&gt; Percent Agreement      0.8181818 0.1256090 0.5417184        1</span></span>
<span><span class="co">#&gt; Gwet's AC1             0.7754441 0.1429500 0.4608133        1</span></span>
<span><span class="co">#&gt; Fleiss' Kappa          0.7611693 0.1530192 0.4243763        1</span></span>
<span><span class="co">#&gt; Kririppendorff's Alpha 0.7434211 0.1454787 0.4192743        1</span></span></code></pre></div>
<p>Or, perform it with weighting.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/agree_coef.html">agree_coef</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ratermat2</span>,</span>
<span>                    wide <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    weighted <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rater1"</span>, <span class="st">"Rater2"</span>, <span class="st">"Rater3"</span>, <span class="st">"Rater4"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                              est         se  lower.ci upper.ci</span></span>
<span><span class="co">#&gt; Percent Agreement      0.9753788 0.09061628 0.7759337        1</span></span>
<span><span class="co">#&gt; Gwet's AC2             0.9140007 0.10396224 0.6851814        1</span></span>
<span><span class="co">#&gt; Fleiss' Kappa          0.8649351 0.14603361 0.5435173        1</span></span>
<span><span class="co">#&gt; Kririppendorff's Alpha 0.8491071 0.12905120 0.5615632        1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-gwet" class="csl-entry">
Gwet, Kilem L. 2014. <em>Handbook of Inter-Rater Reliability</em>.
Advanced Analytics, LLC. <a href="https://www.agreestat.com/book4/" class="external-link">https://www.agreestat.com/book4/</a>.
</div>
<div id="ref-irrCAC" class="csl-entry">
———. 2019. <em>irrCAC: Computing Chance-Corrected Agreement Coefficients
(CAC)</em>. <a href="https://CRAN.R-project.org/package=irrCAC" class="external-link">https://CRAN.R-project.org/package=irrCAC</a>.
</div>
<div id="ref-mcgraw1996" class="csl-entry">
McGraw, Kenneth O, and Seok P Wong. 1996. <span>“Forming Inferences
about Some Intraclass Correlation Coefficients.”</span>
<em>Psychological Methods</em> 1 (1): 30. <a href="https://doi.org/10.1037/1082-989X.1.1.30" class="external-link">https://doi.org/10.1037/1082-989X.1.1.30</a>.
</div>
<div id="ref-shrout1979" class="csl-entry">
Shrout, Patrick E, and Joseph L Fleiss. 1979. <span>“Intraclass
Correlations: Uses in Assessing Rater Reliability.”</span>
<em>Psychological Bulletin</em> 86 (2): 420. <a href="https://doi.org/10.1037/0033-2909.86.2.420" class="external-link">https://doi.org/10.1037/0033-2909.86.2.420</a>.
</div>
<div id="ref-weir2005" class="csl-entry">
Weir, Joseph P. 2005. <span>“Quantifying Test-Retest Reliability Using
the Intraclass Correlation Coefficient and the <span>SEM</span>.”</span>
<em>The Journal of Strength and Conditioning Research</em> 19 (1): 231.
<a href="https://pubmed.ncbi.nlm.nih.gov/15705040/" class="external-link">https://pubmed.ncbi.nlm.nih.gov/15705040/</a>.
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>The paper by Weir also appears to heavily rely on the
work of <span class="citation">Shrout and Fleiss (<a href="#ref-shrout1979">1979</a>)</span> and <span class="citation">McGraw and Wong (<a href="#ref-mcgraw1996">1996</a>)</span><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>This section was previously incorrect. The variance
calculation used to utilize <span class="math inline">\(n_j\)</span>
instead of N.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Also called “%SEM” in some texts. Equivalent to MSE if
the <code>se_type</code> is set to “MSE”<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Aaron Caldwell.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
