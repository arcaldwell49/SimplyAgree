<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Daniel Lüdecke" />

<meta name="date" content="2021-05-11" />

<title>Labelled Data and the sjlabelled-Package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Labelled Data and the sjlabelled-Package</h1>
<h4 class="author">Daniel Lüdecke</h4>
<h4 class="date">2021-05-11</h4>



<p>This package provides functions to read and write data between R and other statistical software packages like <em>SPSS</em>, <em>SAS</em> or <em>Stata</em> and to work with labelled data; this includes easy ways to get and set label attributes, to convert labelled vectors into factors (and vice versa), or to deal with multiple declared missing values etc.</p>
<p>This vignette gives an overview of functions to work with labelled data.</p>
<div id="labelled-data" class="section level1">
<h1>Labelled Data</h1>
<p><em>Labelled data</em> (or labelled vectors) is a common data structure in other statistical environments to store meta-information about variables, like variable names, value labels or multiple defined missing values.</p>
<p>Labelled data not only extends <strong>R</strong>’s capabilities to deal with proper value <em>and</em> variable labels, but also facilitates the representation of different types of missing values, like in other statistical software packages. Typically, in R, multiple declared missings cannot be represented in a similar way, like in ‘SPSS’ or ‘SAS’, with the regular missing values. However, the <strong>haven</strong>-package introduced <code>tagged_na</code> values, which can do this. Tagged NA’s work exactly like regular R missing values except that they store one additional byte of information: a tag, which is usually a letter (“a” to “z”) or also may be a character number (“0” to “9”). This allows to indicate different missings.</p>
<p>Functions of <strong>sjlabelled</strong> do not necessarily require vectors of class <code>labelled</code> or <code>haven_labelled</code>. The <code>labelled</code> class, implemented by the packages <strong>haven</strong> and <strong>labelled</strong>, may cause troubles with other packages, thus it’s only intended as being an intermediate data structure that should be converted to common R classes. However, coercing a <code>labelled</code> vector to other classes (like factor or numeric) typically means that meta information like value and variable label attributes are lost. Actually, there is no need to drop these attributes for non-<code>labelled</code>-class vectors. Functions like <code>lm()</code> simply copy these attributes to the data that is included in the returned object. Packages like <strong>sjPlot</strong> support labelled data for easily annotated data visualization. <strong>sjlabelled</strong> supports working with <em>labelled data</em> and offers functions to benefit from these features.</p>
<p><strong>Note:</strong> Since package-version 2.0 of the <strong>haven</strong>-package, the <code>labelled</code>-class attribute was changed to <code>haven_labelled</code>, to avoid interferences with the <strong>Hmisc</strong>-package.</p>
<div id="labelled-data-in-haven-and-labelled" class="section level2">
<h2>Labelled Data in haven and labelled</h2>
<p>The <strong>labelled</strong>-package is intended to support <code>labelled</code> / <code>haven_labelled</code> metadata structures, thus the data structure of labelled vectors in <strong>haven</strong> and <strong>labelled</strong> is the same.</p>
<p>Labelled data in this format stores information about value labels, variable names and multiple defined missing values. However, <em>variable names</em> are only part of this information if data was imported with one of <strong>haven</strong>’s read-functions. Adding a variable label attribute is (at least up to version 1.0.0) not possible via the <code>labelled()</code>-constructor method.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(haven)</span>
<span id="cb1-2"><a href="#cb1-2"></a>x &lt;-<span class="st"> </span><span class="kw">labelled</span>(</span>
<span id="cb1-3"><a href="#cb1-3"></a>  <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="kw">tagged_na</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;z&quot;</span>), <span class="dv">4</span><span class="op">:</span><span class="dv">1</span>),</span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="kw">c</span>(<span class="st">&quot;Agreement&quot;</span> =<span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Disagreement&quot;</span> =<span class="st"> </span><span class="dv">4</span>, <span class="st">&quot;First&quot;</span> =<span class="st"> </span><span class="kw">tagged_na</span>(<span class="st">&quot;c&quot;</span>),</span>
<span id="cb1-5"><a href="#cb1-5"></a>    <span class="st">&quot;Refused&quot;</span> =<span class="st"> </span><span class="kw">tagged_na</span>(<span class="st">&quot;a&quot;</span>), <span class="st">&quot;Not home&quot;</span> =<span class="st"> </span><span class="kw">tagged_na</span>(<span class="st">&quot;z&quot;</span>))</span>
<span id="cb1-6"><a href="#cb1-6"></a>  )</span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">print</span>(x)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">#&gt; &lt;labelled&lt;double&gt;[10]&gt;</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">#&gt;  [1]     1     2     3 NA(a) NA(c) NA(z)     4     3     2     1</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">#&gt; </span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co">#&gt; Labels:</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co">#&gt;  value        label</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co">#&gt;      1    Agreement</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co">#&gt;      4 Disagreement</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co">#&gt;  NA(c)        First</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co">#&gt;  NA(a)      Refused</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co">#&gt;  NA(z)     Not home</span></span></code></pre></div>
<p>A <code>labelled</code> vector can either be a numeric or character vector. Conversion to factors copies the value labels as factor levels, but drops the label attributes and missing information:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">is.na</span>(x)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co">#&gt;  [1] FALSE FALSE FALSE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE</span></span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw">as_factor</span>(x)</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt;  [1] Agreement    2            3            Refused      First       </span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#&gt;  [6] Not home     Disagreement 3            2            Agreement   </span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt; Levels: Agreement 2 3 Disagreement Refused First Not home</span></span>
<span id="cb2-8"><a href="#cb2-8"></a></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="kw">is.na</span>(<span class="kw">as_factor</span>(x))</span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">#&gt;  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span></span></code></pre></div>
</div>
<div id="labelled-data-in-sjlabelled" class="section level2">
<h2>Labelled Data in sjlabelled</h2>
<p><strong>sjlabelled</strong> supports label attributes in <strong>haven</strong>-style (<code>label</code> and <code>labels</code>). You’re not restricted to the <code>labelled</code> class for vectors when working with <strong>sjlabelled</strong> and labelled data. Hence, you can have vectors of common R classes and still use information like variable or value labels.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">library</span>(sjlabelled)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co"># sjlabelled-sample data, an atomic vector with label attributes</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="kw">data</span>(efc)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="kw">str</span>(efc<span class="op">$</span>e16sex)</span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">#&gt;  num [1:908] 2 2 2 2 2 2 1 2 2 2 ...</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">#&gt;  - attr(*, &quot;label&quot;)= chr &quot;elder&#39;s gender&quot;</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#&gt;  - attr(*, &quot;labels&quot;)= Named num [1:2] 1 2</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;male&quot; &quot;female&quot;</span></span></code></pre></div>
</div>
</div>
<div id="value-labels" class="section level1">
<h1>Value Labels</h1>
<div id="getting-value-labels" class="section level2">
<h2>Getting value labels</h2>
<p>The <code>get_labels()</code>-method is a generic method to return value labels of a vector or data frame.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">get_labels</span>(efc<span class="op">$</span>e42dep)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#&gt; [1] &quot;independent&quot;          &quot;slightly dependent&quot;   &quot;moderately dependent&quot;</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#&gt; [4] &quot;severely dependent&quot;</span></span></code></pre></div>
<p>You can prefix the value labels with the associated values or return them as named vector with the <code>values</code> argument.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">get_labels</span>(efc<span class="op">$</span>e42dep, <span class="dt">values =</span> <span class="st">&quot;p&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">#&gt; [1] &quot;[1] independent&quot;          &quot;[2] slightly dependent&quot;  </span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt; [3] &quot;[3] moderately dependent&quot; &quot;[4] severely dependent&quot;</span></span></code></pre></div>
<p><code>get_labels()</code> also returns “labels” of factors, even if the factor has no label attributes.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>x &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;mid&quot;</span>, <span class="st">&quot;low&quot;</span>, <span class="st">&quot;hi&quot;</span>, <span class="st">&quot;mid&quot;</span>, <span class="st">&quot;low&quot;</span>))</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw">get_labels</span>(x)</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#&gt; [1] &quot;hi&quot;  &quot;low&quot; &quot;mid&quot;</span></span></code></pre></div>
<p>To ensure that labels are only returned for vectors with label-attribute, use the <code>attr.only</code> argument.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>x &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;mid&quot;</span>, <span class="st">&quot;low&quot;</span>, <span class="st">&quot;hi&quot;</span>, <span class="st">&quot;mid&quot;</span>, <span class="st">&quot;low&quot;</span>))</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">get_labels</span>(x, <span class="dt">attr.only =</span> <span class="ot">TRUE</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>If a vector has a label attribute, only these labels are returned. Non-labelled values are excluded from the output by default…</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># get labels, including tagged NA values</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>x &lt;-<span class="st"> </span><span class="kw">labelled</span>(</span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="kw">tagged_na</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;z&quot;</span>), <span class="dv">4</span><span class="op">:</span><span class="dv">1</span>),</span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="kw">c</span>(<span class="st">&quot;Agreement&quot;</span> =<span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Disagreement&quot;</span> =<span class="st"> </span><span class="dv">4</span>, <span class="st">&quot;First&quot;</span> =<span class="st"> </span><span class="kw">tagged_na</span>(<span class="st">&quot;c&quot;</span>),</span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="st">&quot;Refused&quot;</span> =<span class="st"> </span><span class="kw">tagged_na</span>(<span class="st">&quot;a&quot;</span>), <span class="st">&quot;Not home&quot;</span> =<span class="st"> </span><span class="kw">tagged_na</span>(<span class="st">&quot;z&quot;</span>))</span>
<span id="cb8-6"><a href="#cb8-6"></a>)</span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="kw">get_labels</span>(x)</span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt; [1] &quot;Agreement&quot;    &quot;Disagreement&quot;</span></span></code></pre></div>
<p>… however, you can add non-labelled values to the return value as well, using the <code>non.labelled</code> argument.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">get_labels</span>(x, <span class="dt">non.labelled =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">#&gt; [1] &quot;Agreement&quot;    &quot;2&quot;            &quot;3&quot;            &quot;Disagreement&quot;</span></span></code></pre></div>
<p>Tagged missing values can also be included in the output, using the <code>drop.na</code> argument.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">get_labels</span>(x, <span class="dt">values =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">drop.na =</span> <span class="ot">FALSE</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co">#&gt;              1              4          NA(c)          NA(a)          NA(z) </span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co">#&gt;    &quot;Agreement&quot; &quot;Disagreement&quot;        &quot;First&quot;      &quot;Refused&quot;     &quot;Not home&quot;</span></span></code></pre></div>
</div>
<div id="getting-labelled-values" class="section level2">
<h2>Getting labelled values</h2>
<p>The <code>get_values()</code> method returns the values for labelled values (i.e. values that have an associated label). We still use the vector <code>x</code> from the above examples.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">print</span>(x)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">#&gt; &lt;labelled&lt;double&gt;[10]&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">#&gt;  [1]     1     2     3 NA(a) NA(c) NA(z)     4     3     2     1</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">#&gt; </span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">#&gt; Labels:</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">#&gt;  value        label</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">#&gt;      1    Agreement</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">#&gt;      4 Disagreement</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#&gt;  NA(c)        First</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#&gt;  NA(a)      Refused</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#&gt;  NA(z)     Not home</span></span>
<span id="cb11-12"><a href="#cb11-12"></a></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="kw">get_values</span>(x)</span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co">#&gt; [1] &quot;1&quot;     &quot;4&quot;     &quot;NA(a)&quot; &quot;NA(c)&quot; &quot;NA(z)&quot;</span></span></code></pre></div>
<p>With the <code>drop.na</code> argument you can omit those values from the return values that are defined as missing.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">get_values</span>(x, <span class="dt">drop.na =</span> <span class="ot">TRUE</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co">#&gt; [1] 1 4</span></span></code></pre></div>
</div>
<div id="setting-value-labels" class="section level2">
<h2>Setting value labels</h2>
<p>With <code>set_labels()</code> you can add label attributes to any vector.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">20</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co"># return new labelled vector</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>x &lt;-<span class="st"> </span><span class="kw">set_labels</span>(x, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;very low&quot;</span>, <span class="st">&quot;low&quot;</span>, <span class="st">&quot;mid&quot;</span>, <span class="st">&quot;hi&quot;</span>))</span>
<span id="cb13-5"><a href="#cb13-5"></a>x</span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">#&gt;  [1] 2 1 1 3 4 1 1 1 1 2 3 4 4 2 3 4 1 1 4 2</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">#&gt; attr(,&quot;labels&quot;)</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">#&gt; very low      low      mid       hi </span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">#&gt;        1        2        3        4</span></span></code></pre></div>
<p>If more labels than values are given, only as many labels elements are used as values are present.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>x &lt;-<span class="st"> </span><span class="kw">set_labels</span>(x, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>))</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">#&gt; More labels than values of &quot;x&quot;. Using first 2 labels.</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>x</span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">#&gt; [1] 2 2 3 3 2</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">#&gt; attr(,&quot;labels&quot;)</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">#&gt; a b </span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">#&gt; 2 3</span></span></code></pre></div>
<p>However, you can force to use all labels, even for values that are not in the vector, using the <code>force.labels</code> argument.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>x &lt;-<span class="st"> </span><span class="kw">set_labels</span>(</span>
<span id="cb15-3"><a href="#cb15-3"></a>  x, </span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>), </span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="dt">force.labels =</span> <span class="ot">TRUE</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>)</span>
<span id="cb15-7"><a href="#cb15-7"></a>x</span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">#&gt; [1] 2 2 3 3 2</span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co">#&gt; attr(,&quot;labels&quot;)</span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">#&gt; a b c </span></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co">#&gt; 1 2 3</span></span></code></pre></div>
<p>For vectors with more unique values than labels, additional labels for non-labelled values are added.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="ot">NA</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>x &lt;-<span class="st"> </span><span class="kw">set_labels</span>(x, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;yes&quot;</span>, <span class="st">&quot;maybe&quot;</span>, <span class="st">&quot;no&quot;</span>))</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">#&gt; More values in &quot;x&quot; than length of &quot;labels&quot;. Additional values were added to labels.</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>x</span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">#&gt; [1]  1  2  3  2  4 NA</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">#&gt; attr(,&quot;labels&quot;)</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co">#&gt;   yes maybe    no     4 </span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co">#&gt;     1     2     3     4</span></span></code></pre></div>
<p>Use <code>force.values</code> to add only those labels that have been passed as argument.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="ot">NA</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a>x &lt;-<span class="st"> </span><span class="kw">set_labels</span>(</span>
<span id="cb17-3"><a href="#cb17-3"></a>  x, </span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;yes&quot;</span>, <span class="st">&quot;maybe&quot;</span>, <span class="st">&quot;no&quot;</span>),</span>
<span id="cb17-5"><a href="#cb17-5"></a>  <span class="dt">force.values =</span> <span class="ot">FALSE</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>)</span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="co">#&gt; &quot;x&quot; has more values than &quot;labels&quot;, hence not all values are labelled.</span></span>
<span id="cb17-8"><a href="#cb17-8"></a>x</span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="co">#&gt; [1]  1  2  3  2  4 NA</span></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="co">#&gt; attr(,&quot;labels&quot;)</span></span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="co">#&gt;   yes maybe    no </span></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="co">#&gt;     1     2     3</span></span></code></pre></div>
<p>To add explicit labels for values (without adding more labels than wanted and without dropping labels for values that do not appear in the vector), use a named vector of labels as argument. The arguments <code>force.values</code> and <code>force.labels</code> are ignored when using named vectors.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a>x &lt;-<span class="st"> </span><span class="kw">set_labels</span>(</span>
<span id="cb18-3"><a href="#cb18-3"></a>  x, </span>
<span id="cb18-4"><a href="#cb18-4"></a>  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;strongly agree&quot;</span> =<span class="st"> </span><span class="dv">1</span>, </span>
<span id="cb18-5"><a href="#cb18-5"></a>             <span class="st">&quot;totally disagree&quot;</span> =<span class="st"> </span><span class="dv">4</span>, </span>
<span id="cb18-6"><a href="#cb18-6"></a>             <span class="st">&quot;refused&quot;</span> =<span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb18-7"><a href="#cb18-7"></a>             <span class="st">&quot;missing&quot;</span> =<span class="st"> </span><span class="dv">9</span>)</span>
<span id="cb18-8"><a href="#cb18-8"></a>)</span>
<span id="cb18-9"><a href="#cb18-9"></a>x</span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="co">#&gt; [1] 1 2 3 2 4 5</span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="co">#&gt; attr(,&quot;labels&quot;)</span></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="co">#&gt;   strongly agree totally disagree          refused          missing </span></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="co">#&gt;                1                4                5                9</span></span></code></pre></div>
<p>If you want to set different value labels for a complete data frame, if you provide the labels as a <code>list</code>. For each variable in the data frame, provide a list element with value labels as character vector. Note that the length of the list must be equal to the number of variables (columns) in the data frame.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>tmp &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="dt">a =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="dt">b =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="dt">c =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb19-5"><a href="#cb19-5"></a>)</span>
<span id="cb19-6"><a href="#cb19-6"></a></span>
<span id="cb19-7"><a href="#cb19-7"></a>labels &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb19-8"><a href="#cb19-8"></a>  <span class="kw">c</span>(<span class="st">&quot;one&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;three&quot;</span>),</span>
<span id="cb19-9"><a href="#cb19-9"></a>  <span class="kw">c</span>(<span class="st">&quot;eins&quot;</span>, <span class="st">&quot;zwei&quot;</span>, <span class="st">&quot;drei&quot;</span>),</span>
<span id="cb19-10"><a href="#cb19-10"></a>  <span class="kw">c</span>(<span class="st">&quot;un&quot;</span>, <span class="st">&quot;dos&quot;</span>, <span class="st">&quot;tres&quot;</span>)</span>
<span id="cb19-11"><a href="#cb19-11"></a>)</span>
<span id="cb19-12"><a href="#cb19-12"></a></span>
<span id="cb19-13"><a href="#cb19-13"></a>tmp &lt;-<span class="st"> </span><span class="kw">set_labels</span>(tmp, <span class="dt">labels =</span> labels)</span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="kw">str</span>(tmp)</span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="co">#&gt; &#39;data.frame&#39;:    3 obs. of  3 variables:</span></span>
<span id="cb19-16"><a href="#cb19-16"></a><span class="co">#&gt;  $ a: num  1 2 3</span></span>
<span id="cb19-17"><a href="#cb19-17"></a><span class="co">#&gt;   ..- attr(*, &quot;labels&quot;)= Named num [1:3] 1 2 3</span></span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="co">#&gt;   .. ..- attr(*, &quot;names&quot;)= chr [1:3] &quot;one&quot; &quot;two&quot; &quot;three&quot;</span></span>
<span id="cb19-19"><a href="#cb19-19"></a><span class="co">#&gt;  $ b: num  1 2 3</span></span>
<span id="cb19-20"><a href="#cb19-20"></a><span class="co">#&gt;   ..- attr(*, &quot;labels&quot;)= Named num [1:3] 1 2 3</span></span>
<span id="cb19-21"><a href="#cb19-21"></a><span class="co">#&gt;   .. ..- attr(*, &quot;names&quot;)= chr [1:3] &quot;eins&quot; &quot;zwei&quot; &quot;drei&quot;</span></span>
<span id="cb19-22"><a href="#cb19-22"></a><span class="co">#&gt;  $ c: num  1 2 3</span></span>
<span id="cb19-23"><a href="#cb19-23"></a><span class="co">#&gt;   ..- attr(*, &quot;labels&quot;)= Named num [1:3] 1 2 3</span></span>
<span id="cb19-24"><a href="#cb19-24"></a><span class="co">#&gt;   .. ..- attr(*, &quot;names&quot;)= chr [1:3] &quot;un&quot; &quot;dos&quot; &quot;tres&quot;</span></span></code></pre></div>
<p>You can use <code>set_labels()</code> within a pipe-workflow with <em>dplyr</em>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw">library</span>(sjmisc) <span class="co"># for frq()</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="kw">data</span>(efc)</span>
<span id="cb20-4"><a href="#cb20-4"></a></span>
<span id="cb20-5"><a href="#cb20-5"></a>efc <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="st">  </span><span class="kw">select</span>(c82cop1, c83cop2, c84cop3) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="st">  </span><span class="kw">set_labels</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;not often&quot;</span> =<span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;very often&quot;</span> =<span class="st"> </span><span class="dv">4</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="st">  </span><span class="kw">frq</span>()</span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="co">#&gt; </span></span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="co">#&gt; do you feel you cope well as caregiver? (c82cop1) &lt;numeric&gt;</span></span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="co">#&gt; # total N=908  valid N=901  mean=3.12  sd=0.58</span></span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="co">#&gt; </span></span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="co">#&gt; Value |      Label |   N | Raw % | Valid % | Cum. %</span></span>
<span id="cb20-14"><a href="#cb20-14"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb20-15"><a href="#cb20-15"></a><span class="co">#&gt;     1 |  not often |   3 |  0.33 |    0.33 |   0.33</span></span>
<span id="cb20-16"><a href="#cb20-16"></a><span class="co">#&gt;     2 |          2 |  97 | 10.68 |   10.77 |  11.10</span></span>
<span id="cb20-17"><a href="#cb20-17"></a><span class="co">#&gt;     3 |          3 | 591 | 65.09 |   65.59 |  76.69</span></span>
<span id="cb20-18"><a href="#cb20-18"></a><span class="co">#&gt;     4 | very often | 210 | 23.13 |   23.31 | 100.00</span></span>
<span id="cb20-19"><a href="#cb20-19"></a><span class="co">#&gt;  &lt;NA&gt; |       &lt;NA&gt; |   7 |  0.77 |    &lt;NA&gt; |   &lt;NA&gt;</span></span>
<span id="cb20-20"><a href="#cb20-20"></a><span class="co">#&gt; </span></span>
<span id="cb20-21"><a href="#cb20-21"></a><span class="co">#&gt; </span></span>
<span id="cb20-22"><a href="#cb20-22"></a><span class="co">#&gt; do you find caregiving too demanding? (c83cop2) &lt;numeric&gt;</span></span>
<span id="cb20-23"><a href="#cb20-23"></a><span class="co">#&gt; # total N=908  valid N=902  mean=2.02  sd=0.72</span></span>
<span id="cb20-24"><a href="#cb20-24"></a><span class="co">#&gt; </span></span>
<span id="cb20-25"><a href="#cb20-25"></a><span class="co">#&gt; Value |      Label |   N | Raw % | Valid % | Cum. %</span></span>
<span id="cb20-26"><a href="#cb20-26"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb20-27"><a href="#cb20-27"></a><span class="co">#&gt;     1 |  not often | 186 | 20.48 |   20.62 |  20.62</span></span>
<span id="cb20-28"><a href="#cb20-28"></a><span class="co">#&gt;     2 |          2 | 547 | 60.24 |   60.64 |  81.26</span></span>
<span id="cb20-29"><a href="#cb20-29"></a><span class="co">#&gt;     3 |          3 | 130 | 14.32 |   14.41 |  95.68</span></span>
<span id="cb20-30"><a href="#cb20-30"></a><span class="co">#&gt;     4 | very often |  39 |  4.30 |    4.32 | 100.00</span></span>
<span id="cb20-31"><a href="#cb20-31"></a><span class="co">#&gt;  &lt;NA&gt; |       &lt;NA&gt; |   6 |  0.66 |    &lt;NA&gt; |   &lt;NA&gt;</span></span>
<span id="cb20-32"><a href="#cb20-32"></a><span class="co">#&gt; </span></span>
<span id="cb20-33"><a href="#cb20-33"></a><span class="co">#&gt; </span></span>
<span id="cb20-34"><a href="#cb20-34"></a><span class="co">#&gt; does caregiving cause difficulties in your relationship with your friends? (c84cop3) &lt;numeric&gt;</span></span>
<span id="cb20-35"><a href="#cb20-35"></a><span class="co">#&gt; # total N=908  valid N=902  mean=1.63  sd=0.87</span></span>
<span id="cb20-36"><a href="#cb20-36"></a><span class="co">#&gt; </span></span>
<span id="cb20-37"><a href="#cb20-37"></a><span class="co">#&gt; Value |      Label |   N | Raw % | Valid % | Cum. %</span></span>
<span id="cb20-38"><a href="#cb20-38"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb20-39"><a href="#cb20-39"></a><span class="co">#&gt;     1 |  not often | 516 | 56.83 |   57.21 |  57.21</span></span>
<span id="cb20-40"><a href="#cb20-40"></a><span class="co">#&gt;     2 |          2 | 252 | 27.75 |   27.94 |  85.14</span></span>
<span id="cb20-41"><a href="#cb20-41"></a><span class="co">#&gt;     3 |          3 |  82 |  9.03 |    9.09 |  94.24</span></span>
<span id="cb20-42"><a href="#cb20-42"></a><span class="co">#&gt;     4 | very often |  52 |  5.73 |    5.76 | 100.00</span></span>
<span id="cb20-43"><a href="#cb20-43"></a><span class="co">#&gt;  &lt;NA&gt; |       &lt;NA&gt; |   6 |  0.66 |    &lt;NA&gt; |   &lt;NA&gt;</span></span></code></pre></div>
</div>
</div>
<div id="variable-labels" class="section level1">
<h1>Variable Labels</h1>
<div id="getting-variable-labels" class="section level2">
<h2>Getting variable labels</h2>
<p>The <code>get_label()</code>-method returns the variable label of a vector or all variable labels from a data frame.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">get_label</span>(efc<span class="op">$</span>e42dep)</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="co">#&gt; [1] &quot;elder&#39;s dependency&quot;</span></span>
<span id="cb21-3"><a href="#cb21-3"></a></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="kw">get_label</span>(efc, e42dep, e16sex, e15relat)</span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="co">#&gt;                  e42dep                  e16sex                e15relat </span></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="co">#&gt;    &quot;elder&#39;s dependency&quot;        &quot;elder&#39;s gender&quot; &quot;relationship to elder&quot;</span></span></code></pre></div>
<p>If a vector has no variable label, <code>NULL</code> is returned. However, <code>get_label()</code> also allows returning a standard value instead of <code>NULL</code>, in case the vector has no label attribute. This is useful to combine with <code>deparse(substitute())</code> in function calls, so - for instance - the name of the vector can be used as default value if no variable labels are present.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>dummy &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a>testit &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">get_label</span>(x, <span class="dt">def.value =</span> <span class="kw">deparse</span>(<span class="kw">substitute</span>(x)))</span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="co"># returns name of vector, if it has no variable label</span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="kw">testit</span>(dummy)</span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co">#&gt; [1] &quot;dummy&quot;</span></span></code></pre></div>
<p>If you want human-readable labels, you can use the <code>case</code>-argument, which will pass the labels to a string parser in the <a href="https://cran.r-project.org/package=snakecase">snakecase-package</a>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">data</span>(iris)</span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co"># returns no labels, because iris-data is not labelled</span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="kw">get_label</span>(iris)</span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="co">#&gt; Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species </span></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="co">#&gt;           &quot;&quot;           &quot;&quot;           &quot;&quot;           &quot;&quot;           &quot;&quot;</span></span>
<span id="cb23-7"><a href="#cb23-7"></a></span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="co"># returns the column name as default labels, if data is not labelled</span></span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="kw">get_label</span>(iris, <span class="dt">def.value =</span> <span class="kw">colnames</span>(iris))</span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="co">#&gt;   Sepal.Length    Sepal.Width   Petal.Length    Petal.Width        Species </span></span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="co">#&gt; &quot;Sepal.Length&quot;  &quot;Sepal.Width&quot; &quot;Petal.Length&quot;  &quot;Petal.Width&quot;      &quot;Species&quot;</span></span>
<span id="cb23-12"><a href="#cb23-12"></a></span>
<span id="cb23-13"><a href="#cb23-13"></a><span class="co"># labels are parsed in a readable way</span></span>
<span id="cb23-14"><a href="#cb23-14"></a><span class="kw">get_label</span>(iris, <span class="dt">def.value =</span> <span class="kw">colnames</span>(iris), <span class="dt">case =</span> <span class="st">&quot;parsed&quot;</span>)</span>
<span id="cb23-15"><a href="#cb23-15"></a><span class="co">#&gt;   Sepal.Length    Sepal.Width   Petal.Length    Petal.Width        Species </span></span>
<span id="cb23-16"><a href="#cb23-16"></a><span class="co">#&gt; &quot;Sepal Length&quot;  &quot;Sepal Width&quot; &quot;Petal Length&quot;  &quot;Petal Width&quot;      &quot;Species&quot;</span></span></code></pre></div>
</div>
<div id="setting-variable-labels" class="section level2">
<h2>Setting variable labels</h2>
<p>The <code>set_label()</code> function adds the variable label attribute to a vector. You can either return a new vector, or label an existing vector</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="co"># return new vector</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>x &lt;-<span class="st"> </span><span class="kw">set_label</span>(x, <span class="dt">label =</span> <span class="st">&quot;Dummy-variable&quot;</span>)</span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="kw">str</span>(x)</span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="co">#&gt;  int [1:10] 1 4 3 2 1 1 1 3 2 3</span></span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="co">#&gt;  - attr(*, &quot;label&quot;)= chr &quot;Dummy-variable&quot;</span></span>
<span id="cb24-8"><a href="#cb24-8"></a></span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="co"># label existing vector</span></span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="kw">set_label</span>(x) &lt;-<span class="st"> &quot;Another Dummy-variable&quot;</span></span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="kw">str</span>(x)</span>
<span id="cb24-12"><a href="#cb24-12"></a><span class="co">#&gt;  int [1:10] 1 4 3 2 1 1 1 3 2 3</span></span>
<span id="cb24-13"><a href="#cb24-13"></a><span class="co">#&gt;  - attr(*, &quot;label&quot;)= chr &quot;Another Dummy-variable&quot;</span></span></code></pre></div>
<p><code>set_label()</code> can also set variable labels for a data frame. In this case, the variable attributes get an additional <code>name</code> attribute with the vector’s name. This makes it easier to see which label belongs to which vector.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>x &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="dt">a =</span> <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>),</span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="dt">b =</span> <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>),</span>
<span id="cb25-4"><a href="#cb25-4"></a>  <span class="dt">c =</span> <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb25-5"><a href="#cb25-5"></a>)</span>
<span id="cb25-6"><a href="#cb25-6"></a>x &lt;-<span class="st"> </span><span class="kw">set_label</span>(x, <span class="dt">label =</span> <span class="kw">c</span>(<span class="st">&quot;Variable A&quot;</span>,</span>
<span id="cb25-7"><a href="#cb25-7"></a>                            <span class="st">&quot;Variable B&quot;</span>,</span>
<span id="cb25-8"><a href="#cb25-8"></a>                            <span class="st">&quot;Variable C&quot;</span>))</span>
<span id="cb25-9"><a href="#cb25-9"></a></span>
<span id="cb25-10"><a href="#cb25-10"></a><span class="kw">str</span>(x)</span>
<span id="cb25-11"><a href="#cb25-11"></a><span class="co">#&gt; &#39;data.frame&#39;:    10 obs. of  3 variables:</span></span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="co">#&gt;  $ a: int  4 3 1 4 4 3 2 4 3 4</span></span>
<span id="cb25-13"><a href="#cb25-13"></a><span class="co">#&gt;   ..- attr(*, &quot;label&quot;)= Named chr &quot;Variable A&quot;</span></span>
<span id="cb25-14"><a href="#cb25-14"></a><span class="co">#&gt;   .. ..- attr(*, &quot;names&quot;)= chr &quot;a&quot;</span></span>
<span id="cb25-15"><a href="#cb25-15"></a><span class="co">#&gt;  $ b: int  4 4 2 1 4 2 2 3 2 2</span></span>
<span id="cb25-16"><a href="#cb25-16"></a><span class="co">#&gt;   ..- attr(*, &quot;label&quot;)= Named chr &quot;Variable B&quot;</span></span>
<span id="cb25-17"><a href="#cb25-17"></a><span class="co">#&gt;   .. ..- attr(*, &quot;names&quot;)= chr &quot;b&quot;</span></span>
<span id="cb25-18"><a href="#cb25-18"></a><span class="co">#&gt;  $ c: int  4 1 2 4 3 1 2 3 4 2</span></span>
<span id="cb25-19"><a href="#cb25-19"></a><span class="co">#&gt;   ..- attr(*, &quot;label&quot;)= Named chr &quot;Variable C&quot;</span></span>
<span id="cb25-20"><a href="#cb25-20"></a><span class="co">#&gt;   .. ..- attr(*, &quot;names&quot;)= chr &quot;c&quot;</span></span>
<span id="cb25-21"><a href="#cb25-21"></a></span>
<span id="cb25-22"><a href="#cb25-22"></a><span class="kw">get_label</span>(x)</span>
<span id="cb25-23"><a href="#cb25-23"></a><span class="co">#&gt;            a            b            c </span></span>
<span id="cb25-24"><a href="#cb25-24"></a><span class="co">#&gt; &quot;Variable A&quot; &quot;Variable B&quot; &quot;Variable C&quot;</span></span></code></pre></div>
<p>An alternative to <code>set_label()</code> is <code>var_labels()</code>, which also works within pipe-workflows. <code>var_labels()</code> requires named vectors as arguments to match the column names of the input, and set the associated variable labels.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>x &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="dt">a =</span> <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>),</span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="dt">b =</span> <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>),</span>
<span id="cb26-4"><a href="#cb26-4"></a>  <span class="dt">c =</span> <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb26-5"><a href="#cb26-5"></a>)</span>
<span id="cb26-6"><a href="#cb26-6"></a></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="kw">library</span>(magrittr) <span class="co"># for pipe</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>x <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="st">  </span><span class="kw">var_labels</span>(</span>
<span id="cb26-10"><a href="#cb26-10"></a>    <span class="dt">a =</span> <span class="st">&quot;Variable A&quot;</span>,</span>
<span id="cb26-11"><a href="#cb26-11"></a>    <span class="dt">b =</span> <span class="st">&quot;Variable B&quot;</span>,</span>
<span id="cb26-12"><a href="#cb26-12"></a>    <span class="dt">c =</span> <span class="st">&quot;Variable C&quot;</span></span>
<span id="cb26-13"><a href="#cb26-13"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-14"><a href="#cb26-14"></a><span class="st">  </span><span class="kw">str</span>()</span>
<span id="cb26-15"><a href="#cb26-15"></a><span class="co">#&gt; &#39;data.frame&#39;:    10 obs. of  3 variables:</span></span>
<span id="cb26-16"><a href="#cb26-16"></a><span class="co">#&gt;  $ a: int  1 2 3 3 1 2 2 2 2 4</span></span>
<span id="cb26-17"><a href="#cb26-17"></a><span class="co">#&gt;   ..- attr(*, &quot;label&quot;)= chr &quot;Variable A&quot;</span></span>
<span id="cb26-18"><a href="#cb26-18"></a><span class="co">#&gt;  $ b: int  3 1 1 2 4 2 3 1 3 4</span></span>
<span id="cb26-19"><a href="#cb26-19"></a><span class="co">#&gt;   ..- attr(*, &quot;label&quot;)= chr &quot;Variable B&quot;</span></span>
<span id="cb26-20"><a href="#cb26-20"></a><span class="co">#&gt;  $ c: int  1 1 3 2 2 2 1 1 2 1</span></span>
<span id="cb26-21"><a href="#cb26-21"></a><span class="co">#&gt;   ..- attr(*, &quot;label&quot;)= chr &quot;Variable C&quot;</span></span></code></pre></div>
</div>
</div>
<div id="missing-values" class="section level1">
<h1>Missing Values</h1>
<div id="defining-missing-values" class="section level2">
<h2>Defining missing values</h2>
<p><code>set_na()</code> converts values of a vector or of multiple vectors in a data frame into <code>NA</code>s. With <code>as.tag = TRUE</code>, <code>set_na()</code> creates tagged <code>NA</code> values, which means that these missing values get an information tag and a value label (which is, by default, the former value that was converted to NA). You can either return a new vector/data frame, or set <code>NA</code>s into an existing vector/data frame.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, <span class="dv">100</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="co"># show value distribution</span></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="kw">table</span>(x)</span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="co">#&gt; x</span></span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="co">#&gt;  1  2  3  4  5  6  7  8 </span></span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="co">#&gt; 15 15  8 15  9 10 18 10</span></span>
<span id="cb27-7"><a href="#cb27-7"></a></span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="co"># set value 1 and 8 as tagged missings</span></span>
<span id="cb27-9"><a href="#cb27-9"></a>x &lt;-<span class="st"> </span><span class="kw">set_na</span>(x, <span class="dt">na =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">8</span>), <span class="dt">as.tag =</span> <span class="ot">TRUE</span>)</span>
<span id="cb27-10"><a href="#cb27-10"></a>x</span>
<span id="cb27-11"><a href="#cb27-11"></a><span class="co">#&gt;   [1] NA  6  4  6  5  2  7 NA  7  4  7 NA NA  4  5  2 NA NA NA  4  2  2  4  4 NA</span></span>
<span id="cb27-12"><a href="#cb27-12"></a><span class="co">#&gt;  [26]  7  7  2 NA  4  3  3  2 NA  2 NA  4  3  4  4  3  2  4  5  2  5  5  7  6  5</span></span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="co">#&gt;  [51]  5  2  7 NA  7 NA NA  6  4  6  2 NA  4  7  7 NA  3 NA  7  2  6 NA  3 NA  7</span></span>
<span id="cb27-14"><a href="#cb27-14"></a><span class="co">#&gt;  [76]  5  3 NA  6  7  3  4  2 NA  7  5 NA NA NA NA  7  6  2  6  6  7  2  7  4  7</span></span>
<span id="cb27-15"><a href="#cb27-15"></a><span class="co">#&gt; attr(,&quot;labels&quot;)</span></span>
<span id="cb27-16"><a href="#cb27-16"></a><span class="co">#&gt;  1  8 </span></span>
<span id="cb27-17"><a href="#cb27-17"></a><span class="co">#&gt; NA NA</span></span>
<span id="cb27-18"><a href="#cb27-18"></a></span>
<span id="cb27-19"><a href="#cb27-19"></a><span class="co"># show value distribution, including missings</span></span>
<span id="cb27-20"><a href="#cb27-20"></a><span class="kw">table</span>(x, <span class="dt">useNA =</span> <span class="st">&quot;always&quot;</span>)</span>
<span id="cb27-21"><a href="#cb27-21"></a><span class="co">#&gt; x</span></span>
<span id="cb27-22"><a href="#cb27-22"></a><span class="co">#&gt;    2    3    4    5    6    7 &lt;NA&gt; </span></span>
<span id="cb27-23"><a href="#cb27-23"></a><span class="co">#&gt;   15    8   15    9   10   18   25</span></span>
<span id="cb27-24"><a href="#cb27-24"></a></span>
<span id="cb27-25"><a href="#cb27-25"></a><span class="co"># now let&#39;s see, which NA&#39;s were &quot;1&quot; and which were &quot;8&quot;</span></span>
<span id="cb27-26"><a href="#cb27-26"></a><span class="kw">print_tagged_na</span>(x)</span>
<span id="cb27-27"><a href="#cb27-27"></a><span class="co">#&gt;   [1] NA(1)     6     4     6     5     2     7 NA(1)     7     4     7 NA(1)</span></span>
<span id="cb27-28"><a href="#cb27-28"></a><span class="co">#&gt;  [13] NA(1)     4     5     2 NA(1) NA(8) NA(8)     4     2     2     4     4</span></span>
<span id="cb27-29"><a href="#cb27-29"></a><span class="co">#&gt;  [25] NA(1)     7     7     2 NA(1)     4     3     3     2 NA(1)     2 NA(1)</span></span>
<span id="cb27-30"><a href="#cb27-30"></a><span class="co">#&gt;  [37]     4     3     4     4     3     2     4     5     2     5     5     7</span></span>
<span id="cb27-31"><a href="#cb27-31"></a><span class="co">#&gt;  [49]     6     5     5     2     7 NA(1)     7 NA(8) NA(8)     6     4     6</span></span>
<span id="cb27-32"><a href="#cb27-32"></a><span class="co">#&gt;  [61]     2 NA(1)     4     7     7 NA(1)     3 NA(1)     7     2     6 NA(1)</span></span>
<span id="cb27-33"><a href="#cb27-33"></a><span class="co">#&gt;  [73]     3 NA(8)     7     5     3 NA(8)     6     7     3     4     2 NA(1)</span></span>
<span id="cb27-34"><a href="#cb27-34"></a><span class="co">#&gt;  [85]     7     5 NA(8) NA(8) NA(8) NA(8)     7     6     2     6     6     7</span></span>
<span id="cb27-35"><a href="#cb27-35"></a><span class="co">#&gt;  [97]     2     7     4     7</span></span>
<span id="cb27-36"><a href="#cb27-36"></a></span>
<span id="cb27-37"><a href="#cb27-37"></a>x &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>))</span>
<span id="cb27-38"><a href="#cb27-38"></a>x</span>
<span id="cb27-39"><a href="#cb27-39"></a><span class="co">#&gt; [1] a b c</span></span>
<span id="cb27-40"><a href="#cb27-40"></a><span class="co">#&gt; Levels: a b c</span></span>
<span id="cb27-41"><a href="#cb27-41"></a></span>
<span id="cb27-42"><a href="#cb27-42"></a><span class="co"># set NA into existing vector</span></span>
<span id="cb27-43"><a href="#cb27-43"></a>x &lt;-<span class="st"> </span><span class="kw">set_na</span>(x, <span class="dt">na =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">as.tag =</span> <span class="ot">TRUE</span>)</span>
<span id="cb27-44"><a href="#cb27-44"></a>x</span>
<span id="cb27-45"><a href="#cb27-45"></a><span class="co">#&gt; [1] a    &lt;NA&gt; c   </span></span>
<span id="cb27-46"><a href="#cb27-46"></a><span class="co">#&gt; attr(,&quot;labels&quot;)</span></span>
<span id="cb27-47"><a href="#cb27-47"></a><span class="co">#&gt;  b </span></span>
<span id="cb27-48"><a href="#cb27-48"></a><span class="co">#&gt; NA </span></span>
<span id="cb27-49"><a href="#cb27-49"></a><span class="co">#&gt; Levels: a c</span></span></code></pre></div>
</div>
<div id="getting-missing-values" class="section level2">
<h2>Getting missing values</h2>
<p>The <code>get_na()</code> function returns all tagged NA values. We still use the vector <code>x</code> from the previous example.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">get_na</span>(x)</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="co">#&gt;  b </span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="co">#&gt; NA</span></span></code></pre></div>
<p>To see the tags of the NA values, use the <code>as.tag</code> argument.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">get_na</span>(x, <span class="dt">as.tag =</span> <span class="ot">TRUE</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="co">#&gt;       b </span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="co">#&gt; &quot;NA(b)&quot;</span></span></code></pre></div>
</div>
<div id="replacing-specific-na-with-values" class="section level2">
<h2>Replacing specific NA with values</h2>
<p>While <code>set_na()</code> allows you to replace values with (tagged) NA’s, <code>replace_na()</code> (from package <strong>sjmisc</strong>) allows you to replace either all NA values of a vector or specific tagged NA values with a non-NA value.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">library</span>(sjmisc) <span class="co"># for replace_na()</span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="kw">data</span>(efc)</span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="kw">str</span>(efc<span class="op">$</span>c84cop3)</span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="co">#&gt;  num [1:908] 2 3 1 3 1 3 4 2 3 1 ...</span></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="co">#&gt;  - attr(*, &quot;label&quot;)= chr &quot;does caregiving cause difficulties in your relationship with your friends?&quot;</span></span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="co">#&gt;  - attr(*, &quot;labels&quot;)= Named num [1:4] 1 2 3 4</span></span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:4] &quot;Never&quot; &quot;Sometimes&quot; &quot;Often&quot; &quot;Always&quot;</span></span>
<span id="cb30-8"><a href="#cb30-8"></a></span>
<span id="cb30-9"><a href="#cb30-9"></a>efc<span class="op">$</span>c84cop3 &lt;-<span class="st"> </span><span class="kw">set_na</span>(efc<span class="op">$</span>c84cop3, <span class="dt">na =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">as.tag =</span> <span class="ot">TRUE</span>)</span>
<span id="cb30-10"><a href="#cb30-10"></a><span class="kw">get_na</span>(efc<span class="op">$</span>c84cop3, <span class="dt">as.tag =</span> <span class="ot">TRUE</span>)</span>
<span id="cb30-11"><a href="#cb30-11"></a><span class="co">#&gt; Sometimes     Often </span></span>
<span id="cb30-12"><a href="#cb30-12"></a><span class="co">#&gt;   &quot;NA(2)&quot;   &quot;NA(3)&quot;</span></span>
<span id="cb30-13"><a href="#cb30-13"></a></span>
<span id="cb30-14"><a href="#cb30-14"></a><span class="co"># this would replace all NA&#39;s into &quot;2&quot;</span></span>
<span id="cb30-15"><a href="#cb30-15"></a>dummy &lt;-<span class="st"> </span><span class="kw">replace_na</span>(efc<span class="op">$</span>c84cop3, <span class="dt">value =</span> <span class="dv">2</span>)</span>
<span id="cb30-16"><a href="#cb30-16"></a></span>
<span id="cb30-17"><a href="#cb30-17"></a><span class="co"># labels of former tagged NA&#39;s are preserved</span></span>
<span id="cb30-18"><a href="#cb30-18"></a><span class="kw">get_labels</span>(dummy, <span class="dt">drop.na =</span> <span class="ot">FALSE</span>, <span class="dt">values =</span> <span class="st">&quot;p&quot;</span>)</span>
<span id="cb30-19"><a href="#cb30-19"></a><span class="co">#&gt; [1] &quot;[1] Never&quot;         &quot;[4] Always&quot;        &quot;[NA(2)] Sometimes&quot;</span></span>
<span id="cb30-20"><a href="#cb30-20"></a><span class="co">#&gt; [4] &quot;[NA(3)] Often&quot;</span></span>
<span id="cb30-21"><a href="#cb30-21"></a><span class="kw">get_na</span>(dummy, <span class="dt">as.tag =</span> <span class="ot">TRUE</span>)</span>
<span id="cb30-22"><a href="#cb30-22"></a><span class="co">#&gt; Sometimes     Often </span></span>
<span id="cb30-23"><a href="#cb30-23"></a><span class="co">#&gt;   &quot;NA(2)&quot;   &quot;NA(3)&quot;</span></span>
<span id="cb30-24"><a href="#cb30-24"></a></span>
<span id="cb30-25"><a href="#cb30-25"></a><span class="co"># No more NA values</span></span>
<span id="cb30-26"><a href="#cb30-26"></a><span class="kw">frq</span>(dummy)</span>
<span id="cb30-27"><a href="#cb30-27"></a><span class="co">#&gt; </span></span>
<span id="cb30-28"><a href="#cb30-28"></a><span class="co">#&gt; does caregiving cause difficulties in your relationship with your friends? (x) &lt;numeric&gt;</span></span>
<span id="cb30-29"><a href="#cb30-29"></a><span class="co">#&gt; # total N=908  valid N=908  mean=1.55  sd=0.77</span></span>
<span id="cb30-30"><a href="#cb30-30"></a><span class="co">#&gt; </span></span>
<span id="cb30-31"><a href="#cb30-31"></a><span class="co">#&gt; Value |  Label |   N | Raw % | Valid % | Cum. %</span></span>
<span id="cb30-32"><a href="#cb30-32"></a><span class="co">#&gt; -----------------------------------------------</span></span>
<span id="cb30-33"><a href="#cb30-33"></a><span class="co">#&gt;     1 |  Never | 516 | 56.83 |   56.83 |  56.83</span></span>
<span id="cb30-34"><a href="#cb30-34"></a><span class="co">#&gt;     2 |      2 | 340 | 37.44 |   37.44 |  94.27</span></span>
<span id="cb30-35"><a href="#cb30-35"></a><span class="co">#&gt;     4 | Always |  52 |  5.73 |    5.73 | 100.00</span></span>
<span id="cb30-36"><a href="#cb30-36"></a><span class="co">#&gt;  &lt;NA&gt; |   &lt;NA&gt; |   0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;</span></span>
<span id="cb30-37"><a href="#cb30-37"></a></span>
<span id="cb30-38"><a href="#cb30-38"></a></span>
<span id="cb30-39"><a href="#cb30-39"></a><span class="co"># In this example, the tagged NA(2) is replaced with value 2</span></span>
<span id="cb30-40"><a href="#cb30-40"></a><span class="co"># the new value label for value 2 is &quot;restored NA&quot;</span></span>
<span id="cb30-41"><a href="#cb30-41"></a>dummy &lt;-<span class="st"> </span><span class="kw">replace_na</span>(efc<span class="op">$</span>c84cop3, <span class="dt">value =</span> <span class="dv">2</span>, <span class="dt">na.label =</span> <span class="st">&quot;restored NA&quot;</span>, <span class="dt">tagged.na =</span> <span class="st">&quot;2&quot;</span>)</span>
<span id="cb30-42"><a href="#cb30-42"></a></span>
<span id="cb30-43"><a href="#cb30-43"></a><span class="co"># Only one tagged NA remains</span></span>
<span id="cb30-44"><a href="#cb30-44"></a><span class="kw">get_labels</span>(dummy, <span class="dt">drop.na =</span> <span class="ot">FALSE</span>, <span class="dt">values =</span> <span class="st">&quot;p&quot;</span>)</span>
<span id="cb30-45"><a href="#cb30-45"></a><span class="co">#&gt; [1] &quot;[1] Never&quot;       &quot;[2] restored NA&quot; &quot;[4] Always&quot;      &quot;[NA(3)] Often&quot;</span></span>
<span id="cb30-46"><a href="#cb30-46"></a><span class="kw">get_na</span>(dummy, <span class="dt">as.tag =</span> <span class="ot">TRUE</span>)</span>
<span id="cb30-47"><a href="#cb30-47"></a><span class="co">#&gt;   Often </span></span>
<span id="cb30-48"><a href="#cb30-48"></a><span class="co">#&gt; &quot;NA(3)&quot;</span></span>
<span id="cb30-49"><a href="#cb30-49"></a></span>
<span id="cb30-50"><a href="#cb30-50"></a><span class="co"># Some NA values remain</span></span>
<span id="cb30-51"><a href="#cb30-51"></a><span class="kw">frq</span>(dummy)</span>
<span id="cb30-52"><a href="#cb30-52"></a><span class="co">#&gt; </span></span>
<span id="cb30-53"><a href="#cb30-53"></a><span class="co">#&gt; does caregiving cause difficulties in your relationship with your friends? (x) &lt;numeric&gt;</span></span>
<span id="cb30-54"><a href="#cb30-54"></a><span class="co">#&gt; # total N=908  valid N=820  mean=1.50  sd=0.79</span></span>
<span id="cb30-55"><a href="#cb30-55"></a><span class="co">#&gt; </span></span>
<span id="cb30-56"><a href="#cb30-56"></a><span class="co">#&gt; Value |       Label |   N | Raw % | Valid % | Cum. %</span></span>
<span id="cb30-57"><a href="#cb30-57"></a><span class="co">#&gt; ----------------------------------------------------</span></span>
<span id="cb30-58"><a href="#cb30-58"></a><span class="co">#&gt;     1 |       Never | 516 | 56.83 |   62.93 |  62.93</span></span>
<span id="cb30-59"><a href="#cb30-59"></a><span class="co">#&gt;     2 | restored NA | 252 | 27.75 |   30.73 |  93.66</span></span>
<span id="cb30-60"><a href="#cb30-60"></a><span class="co">#&gt;     4 |      Always |  52 |  5.73 |    6.34 | 100.00</span></span>
<span id="cb30-61"><a href="#cb30-61"></a><span class="co">#&gt;  &lt;NA&gt; |        &lt;NA&gt; |  88 |  9.69 |    &lt;NA&gt; |   &lt;NA&gt;</span></span></code></pre></div>
</div>
<div id="replacing-values-labels" class="section level2">
<h2>Replacing values labels</h2>
<p>With <code>replace_labels()</code>, you can replace (change) value labels of labelled values. This can also be used to change the labels of tagged missing values. Make sure to know the missing tag, which can be accessed via <code>get_na()</code>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">str</span>(efc<span class="op">$</span>c82cop1)</span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="co">#&gt;  num [1:908] 3 3 2 4 3 2 4 3 3 3 ...</span></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="co">#&gt;  - attr(*, &quot;label&quot;)= chr &quot;do you feel you cope well as caregiver?&quot;</span></span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="co">#&gt;  - attr(*, &quot;labels&quot;)= Named num [1:4] 1 2 3 4</span></span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:4] &quot;never&quot; &quot;sometimes&quot; &quot;often&quot; &quot;always&quot;</span></span>
<span id="cb31-6"><a href="#cb31-6"></a></span>
<span id="cb31-7"><a href="#cb31-7"></a>efc<span class="op">$</span>c82cop1 &lt;-<span class="st"> </span><span class="kw">set_na</span>(efc<span class="op">$</span>c82cop1, <span class="dt">na =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">as.tag =</span> <span class="ot">TRUE</span>)</span>
<span id="cb31-8"><a href="#cb31-8"></a><span class="kw">get_na</span>(efc<span class="op">$</span>c82cop1, <span class="dt">as.tag =</span> <span class="ot">TRUE</span>)</span>
<span id="cb31-9"><a href="#cb31-9"></a><span class="co">#&gt; sometimes     often </span></span>
<span id="cb31-10"><a href="#cb31-10"></a><span class="co">#&gt;   &quot;NA(2)&quot;   &quot;NA(3)&quot;</span></span>
<span id="cb31-11"><a href="#cb31-11"></a></span>
<span id="cb31-12"><a href="#cb31-12"></a>efc<span class="op">$</span>c82cop1 &lt;-<span class="st"> </span><span class="kw">replace_labels</span>(efc<span class="op">$</span>c82cop1, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;new NA label&quot;</span> =<span class="st"> </span><span class="kw">tagged_na</span>(<span class="st">&quot;2&quot;</span>)))</span>
<span id="cb31-13"><a href="#cb31-13"></a><span class="co">#&gt; tagged NA &#39;sometimes&#39; was replaced with new value label.</span></span>
<span id="cb31-14"><a href="#cb31-14"></a></span>
<span id="cb31-15"><a href="#cb31-15"></a><span class="kw">get_na</span>(efc<span class="op">$</span>c82cop1, <span class="dt">as.tag =</span> <span class="ot">TRUE</span>)</span>
<span id="cb31-16"><a href="#cb31-16"></a><span class="co">#&gt; new NA label        often </span></span>
<span id="cb31-17"><a href="#cb31-17"></a><span class="co">#&gt;      &quot;NA(2)&quot;      &quot;NA(3)&quot;</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
