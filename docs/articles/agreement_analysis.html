<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Agreement &amp; Tolerance Limits • SimplyAgree</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Agreement &amp; Tolerance Limits">
<meta property="og:description" content="SimplyAgree">
<meta property="og:image" content="/images/sticker.png">
<meta property="og:image:alt" content="SimplyAgree logo">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@exphysstudent">
<meta name="twitter:site" content="@exphysstudent">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SimplyAgree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/agreement_analysis.html">Agreement &amp; Tolerance Limits</a>
    </li>
    <li>
      <a href="../articles/agree_tests.html">Agreement Tests</a>
    </li>
    <li>
      <a href="../articles/Deming.html">Deming Regression</a>
    </li>
    <li>
      <a href="../articles/reanalysis.html">Re-analysis of an Agreement Study</a>
    </li>
    <li>
      <a href="../articles/reliability_analysis.html">Reliability Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Agreement &amp; Tolerance Limits</h1>
                        <h4 data-toc-skip class="author">Aaron R.
Caldwell</h4>
            
            <h4 data-toc-skip class="date">Last Updated: 2023-04-16</h4>
      
      
      <div class="hidden name"><code>agreement_analysis.Rmd</code></div>

    </div>

    
    
<p>In this vignette I will briefly demonstrate how
<code>SimplyAgree</code> calculates agreement and tolerance limits. This
vignette assumes the reader has some familiarity with “limits of
agreement” (Bland-Altman limits) and is familiar with the concept of
prediction intervals. Please read the references listed in this vignette
<em>before</em> going further if you are not familiar with these
concepts.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://aaroncaldwell.us/SimplyAgree/" class="external-link">SimplyAgree</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">temps</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="agree-or-tolerate">Agree or Tolerate?<a class="anchor" aria-label="anchor" href="#agree-or-tolerate"></a>
</h2>
<p><span class="citation">Francq, Berger, and Boachie (<a href="#ref-francq2020tolerate" role="doc-biblioref">2020</a>)</span>
pose this question in a paper published in <em>Statistics in
Medicine</em>. Traditionally, those working in medicine or physiology
have defaulted to calculating some form of “limits of agreement” that
<span class="citation">Bland and Altman (<a href="#ref-bland1986" role="doc-biblioref">1986</a>)</span> once recommended. The
recommendation by <span class="citation">Bland and Altman (<a href="#ref-bland1986" role="doc-biblioref">1986</a>)</span> was only an
approximation, and that has undergone many modifications <span class="citation">(<a href="#ref-bland1999" role="doc-biblioref">Bland
and Altman 1999</a>; <a href="#ref-zou2011" role="doc-biblioref">Zou
2011</a>)</span> to improve the accuracy of the agreement interval and
their associated confidence intervals. Meanwhile, the field of
industrial statistics has focused on calculating tolerance limits. There
are R packages, such as the <code>tolerance</code> R package available
on CRAN, that are entirely dedicated to calculating tolerance limits. It
is important to note that tolerance is not limited to the normal
distribution and can be applied to other distributions (please see the
tolerance package for more details). However, in agreement studies
typically seen in medicine, tolerance limits may be a more accurate way
of determining whether two measurements adequately close to one
another.</p>
<p>To quote <span class="citation">Francq, Berger, and Boachie (<a href="#ref-francq2020tolerate" role="doc-biblioref">2020</a>)</span>:</p>
<blockquote>
<p>In terms of terminology, tolerance means, in this context, that some
difference between the methods is tolerated (the measurements are still
comparable in practice). Furthermore, the tolerance interval is exact
and therefore more appropriate than the agreement interval.</p>
</blockquote>
<p>In this package, tolerance limits refer to the “tolerance” associated
with the prediction interval for the difference between 2 measurements.
The calculative approach (detailed much further below) involves
calculated the prediction interval for the difference between two
methods (i.e., an estimate of an interval in which a future observation
will fall, with a certain probability, given what has already been
observed) and then calculating the confidence in the interval (i.e.,
tolerance). Therefore, if we want a 95% prediction interval with 95%
tolerance limits, we are calculating the interval in which 95% of future
observations (prediction) with only a 5% probability (1-tolerance) the
“true” prediction interval limits are greater/less than the upper/lower
tolerance limits.</p>
<p>Personally, I find tolerance limits more attractive for 2 reasons: 1)
the coverage of the prediction intervals and their tolerance limits is
often better than confidence intervals for agreement limits, and 2) the
interpretation of the tolerance limits is much clearer. For a greater
discussion of this topic, please see the manuscript by <span class="citation">Francq, Berger, and Boachie (<a href="#ref-francq2020tolerate" role="doc-biblioref">2020</a>)</span> and
their R package <code>BivRegBLS</code>.</p>
</div>
<div class="section level2">
<h2 id="tolerance">Tolerance<a class="anchor" aria-label="anchor" href="#tolerance"></a>
</h2>
<p>In <code>SimplyAgree</code> we utilize a generalized least square
(GLS) to estimate the tolerance limits. The function uses the
<code>gls</code> function from the <code>nlme</code> R package to build
the model. This allows a <em>very</em> flexible approach for estimating
prediction intervals and tolerance limits.</p>
<p>We can use the <code>tolerance_limits</code> function demonstrate the
basic calculations. In this example (below), we use the
<code>temps</code> data set to measure the differences between
esophageal and rectal temperatures between different times of day
(<code>tod</code>) and controlling for the intra-subject
correlation.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tolerance_limit.html">tolerance_limit</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">temps</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"trec_pre"</span>, <span class="co"># First measure</span></span>
<span>  y <span class="op">=</span> <span class="st">"teso_pre"</span>, <span class="co"># Second measure</span></span>
<span>  id <span class="op">=</span> <span class="st">"id"</span>, <span class="co"># Subject ID</span></span>
<span>  condition <span class="op">=</span> <span class="st">"tod"</span>, <span class="co"># Identify condition that may affect differences</span></span>
<span>  cor_type <span class="op">=</span> <span class="st">"sym"</span> <span class="co"># Set correlation structure as Compound Symmetry</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Agreement between Measures (Difference: x-y)</span></span>
<span><span class="co">#&gt; 95% Prediction Interval with 95% Tolerance Limits</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Condition   Bias          Bias CI Prediction Interval  Tolerance Limits</span></span>
<span><span class="co">#&gt;         AM 0.1537 [0.0595, 0.2478]    [-0.292, 0.5993] [-0.4982, 0.8056]</span></span>
<span><span class="co">#&gt;         PM 0.2280 [0.1342, 0.3218]   [-0.3163, 0.7723] [-0.6984, 1.1544]</span></span></code></pre></div>
<div class="section level3">
<h3 id="calculative-approach">Calculative Approach<a class="anchor" aria-label="anchor" href="#calculative-approach"></a>
</h3>
<p>Overall, the model is fit using the <code>gls</code> function, and I
would suggest reading book by Pinheiro and Bates which details the
function<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. This function is different than the
linear, or linear mixed, models that are utilized in calculating limits
of agreement because it accommodates correlated errors and/or unequal
variances.</p>
<div class="section level4">
<h4 id="arguments-influencing-the-model">Arguments Influencing the Model<a class="anchor" aria-label="anchor" href="#arguments-influencing-the-model"></a>
</h4>
<p>Users of the this function have a number of options with the
arguments provided in the <code>tolerance_limit</code> function. The
only required arguments are <code>x</code>, <code>y</code>, and
<code>data</code> which dictate the data frame, and the columns that
contain the 2 measurements. The <code>id</code> argument, when
specified, identifies the column that contains the subject identifier or
some time of nesting within which the data should be correlated to some
degree. The <code>time</code>, argument is utilized when the data come
from a repeated measures or time series data, and indicates the order of
the data points. The <code>condition</code> argument identifies some
factor within a data frame that may effect the mean difference (and
variance) of the differences between the 2 measurements. The
<code>cor_type</code> argument can also be utilized to specific 1 of 3
possible correlation structure types. Lastly, savvy users can specify a
particular variance or correlation structure using the
<code>weights</code> and <code>correlation</code> arguments which
directly alter the model being fit using <code>gls</code>.</p>
</div>
<div class="section level4">
<h4 id="prediction">Prediction<a class="anchor" aria-label="anchor" href="#prediction"></a>
</h4>
<p>After the model is fit, the marginal means (EMM), and their
associated standard errors (SEM), are calculated based on the
<code>gls</code> fit model using <code>emmeans</code>. The standard
error of prediction (SEP) for each EMM is then calculated using the SEM
and residual standard error from the model (formula below).</p>
<p><span class="math display">\[
SEP = \sqrt{SEM^2 + S^2_{residual} }
\]</span></p>
<p>After the SEP is calculated, the prediction interval can be
calculated with following:</p>
<p><span class="math display">\[
PI = EMM \pm t_{1-\alpha/2, df} \cdot SEP
\]</span></p>
<p><strong>NOTE</strong>: the degrees of freedom (df) are calculated
using approximation of <span class="citation">Satterthwaite (<a href="#ref-satterthwaite1946" role="doc-biblioref">1946</a>)</span> (see
<span class="citation">Kuznetsova, Brockhoff, and Christensen (<a href="#ref-lmertest" role="doc-biblioref">2017</a>)</span> for an
explanation of this implementation in R).</p>
</div>
<div class="section level4">
<h4 id="tolerance-1">Tolerance<a class="anchor" aria-label="anchor" href="#tolerance-1"></a>
</h4>
<p>The type of tolerance limit calculation can be set using the
<code>tol_method</code> argument with options including “approx” and
“perc”. Tolerance limits are calculated either through the “Beta
expectation” approximation (<code>tol_method = "approx"</code>) detailed
by <span class="citation">Francq, Berger, and Boachie (<a href="#ref-francq2020tolerate" role="doc-biblioref">2020</a>)</span> or
through a parametric bootstrap method
(<code>tol_method = "perc"</code>). The bootstrap methods re-samples
from the model and, after a certain number of replicates (default is
1999), calculates the bounds the prediction interval based on the
quantiles of the replicates for the lower and upper limit. The bootstrap
method is preferred for its accuracy and power, but is
<em>extremely</em> slow which may involve computations lasting greater
than 2 minutes. The approximation is the default only because it is
substantially quicker.</p>
<p>The approximate tolerance limits based on the work of <span class="citation">Francq, Berger, and Boachie (<a href="#ref-francq2020tolerate" role="doc-biblioref">2020</a>)</span> are
calculated as the following:</p>
<p><span class="math display">\[
TI = EMM \pm z_{1-\alpha_1/2} \cdot SEP \cdot
\sqrt{\frac{df}{\chi^2_{\alpha_2,df}}}
\]</span> <strong>NOTE</strong>: <span class="math inline">\(\alpha_1\)</span> refers to the alpha-level for
the prediction interval (modified by the <code>pred_level</code>
argument; <code>1-pred_level</code>) whereas <span class="math inline">\(\alpha_2\)</span> refers to the alpha-level for
the tolerance limit (modified by the <code>tol_level</code> argument;
<code>1-tol_level</code>).</p>
</div>
</div>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>In the <code>temps</code> data we have different measures of core
temperature at varying times of day. Let us assume we want to measure
pre-exercise agreement between esophageal and rectal temperature while
controlling for time of day (<code>tod</code>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test1</span> <span class="op">=</span> <span class="fu"><a href="../reference/tolerance_limit.html">tolerance_limit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">temps</span>,</span>
<span>                        x <span class="op">=</span> <span class="st">"teso_pre"</span>,</span>
<span>                        y <span class="op">=</span> <span class="st">"trec_pre"</span>,</span>
<span>                        id <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                        condition <span class="op">=</span> <span class="st">"tod"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test1</span></span>
<span><span class="co">#&gt; Agreement between Measures (Difference: x-y)</span></span>
<span><span class="co">#&gt; 95% Prediction Interval with 95% Tolerance Limits</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Condition    Bias            Bias CI Prediction Interval  Tolerance Limits</span></span>
<span><span class="co">#&gt;         AM -0.1537 [-0.2478, -0.0595]    [-0.5993, 0.292] [-0.8056, 0.4982]</span></span>
<span><span class="co">#&gt;         PM -0.2280 [-0.3218, -0.1342]   [-0.7723, 0.3163] [-1.1544, 0.6984]</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="agreement">Agreement<a class="anchor" aria-label="anchor" href="#agreement"></a>
</h2>
<p>The agreement limits calculations in <code>SimplyAgree</code> are a
tad more constrained that tolerance limits. There are only 3 types of
calculations that can be made: simple, replicate, and nested. The simple
calculation each pair of observations (x and y) are
<em>independent</em>; meaning that each pair represents one
subject/participant. Sometimes there are multiple measurements taken
within subjects when comparing two measurements tools. In some cases the
true underlying value will not be expected to vary (i.e., replicates or
“reps”), or multiple measurements may be taken within an individual
<em>and</em> these values are expected to vary (i.e., nested).</p>
<p>The <code>agreement_limit</code> function, unlike the other agreement
functions in the package (i.e., <code>agree_test</code>,
<code>agree_reps</code>, and <code>agree_nest</code>), allows users to
make any of the three calculations all in one function. Further,
<code>agreement_limit</code> assumes you are only interested in the
outermost confindence interval of the limits of agreement and therefore
one-tailed confidence intervals are only calculated for the LoA.</p>
<div class="section level3">
<h3 id="arguments-influencing-the-loa-calculations">Arguments Influencing the LoA Calculations<a class="anchor" aria-label="anchor" href="#arguments-influencing-the-loa-calculations"></a>
</h3>
<p>Users of the this function have a number of options with the
arguments provided in the <code>agreement_limit</code> function. The
only required arguments are <code>x</code>, <code>y</code>, and
<code>data</code> which dictate the data frame, and the columns that
contain the 2 measurements. The <code>id</code> argument, when
specified, identifies the column that contains the subject identifier.
This is only necessary if it is a replicate or nested design. The type
of design is dictated by <code>data_type</code> argument. Additionally,
the <code>loa_calc</code> function dictates how the limits of agreement
are calculated. Users have the option of computing <span class="citation">Bland and Altman (<a href="#ref-bland1999" role="doc-biblioref">1999</a>)</span> or MOVER <span class="citation">(<a href="#ref-zou2011" role="doc-biblioref">Zou
2011</a>; <a href="#ref-donner2012closed" role="doc-biblioref">Donner
and Zou 2012</a>)</span> limits of agreement (calculations detailed
below). I strongly recommend utilizing the MOVER limits of agreement
over the Bland-Altman limits <span class="citation">(<a href="#ref-zou2011" role="doc-biblioref">Zou 2011</a>; <a href="#ref-donner2012closed" role="doc-biblioref">Donner and Zou
2012</a>)</span>.</p>
</div>
<div class="section level3">
<h3 id="simple-agreement">Simple Agreement<a class="anchor" aria-label="anchor" href="#simple-agreement"></a>
</h3>
<p>In the simplest scenario, a study may be conducted to compare one
measure (e.g., <code>x</code>) and another (e.g., <code>y</code>). In
this scenario each pair of observations (x and y) are
<em>independent</em>; meaning that each pair represents one
subject/participant that is uncorrelated with other pairs.</p>
<p>The data for the two measurements are put into the <code>x</code> and
<code>y</code> arguments.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calc. LoA</span></span>
<span><span class="va">a1</span> <span class="op">=</span> <span class="fu"><a href="../reference/agreement_limit.html">agreement_limit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">reps</span>,</span>
<span>                     x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                     y <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span></span>
<span><span class="co"># print</span></span>
<span><span class="va">a1</span></span>
<span><span class="co">#&gt; MOVER Limits of Agreement (LoA)</span></span>
<span><span class="co">#&gt; 95% LoA @ 5% Alpha-Level</span></span>
<span><span class="co">#&gt; Independent Data Points</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    Bias           Bias CI Lower LoA Upper LoA            LoA CI</span></span>
<span><span class="co">#&gt;  0.4383 [-0.1669, 1.0436]    -1.947     2.824 [-3.0117, 3.8884]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SD of Differences = 1.217</span></span></code></pre></div>
<div class="section level4">
<h4 id="calculation-steps">Calculation Steps<a class="anchor" aria-label="anchor" href="#calculation-steps"></a>
</h4>
<p>The reported limits of agreement are derived from the work of <span class="citation">Bland and Altman (<a href="#ref-bland1986" role="doc-biblioref">1986</a>)</span> and <span class="citation">Bland
and Altman (<a href="#ref-bland1999" role="doc-biblioref">1999</a>)</span>.</p>
<p><strong>LoA</strong></p>
<p><span class="math display">\[
LoA = \bar d \pm z_{1-(1-agree)/2} \cdot S_d
\]</span></p>
<p>wherein <span class="math inline">\(z_{1-(1-agree)/2}\)</span> is the
value of the normal distribution at the given agreement level (default
is 95%), <span class="math inline">\(\bar d\)</span> is the mean of the
differences, and <span class="math inline">\(S_d\)</span> is the
standard deviations of the differences.</p>
<p><strong>Confidence Interval</strong></p>
<ol style="list-style-type: decimal">
<li>Calculate variance of LoA</li>
</ol>
<p><span class="math display">\[
S_{LoA} = S_d \cdot \sqrt{\frac{1}{N}+ \frac{z^2_{1-(1-agree)/2}}{2
\cdot(N-1)} }
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Calculate Left Moving Estimator</li>
</ol>
<p><strong>Bland-Altman Method</strong></p>
<p><span class="math display">\[
LME = t_{1 - \alpha, \space df} \cdot S_{LoA}
\]</span> <strong>MOVER Method</strong> sd_delta * sqrt(confq2^2/k +
agreeq^2 * (sqrt(dfs/qchisq(1-conf2,dfs))-1)^2) <span class="math display">\[
LME = S_d \cdot \sqrt{\frac{z_{1-\alpha}^2}{N} + z^2_{1-agree} \cdot
(\sqrt{\frac{df}{\chi^2_{\alpha,df}}}-1)^2}
\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Calculate Confidence Interval</li>
</ol>
<p><span class="math display">\[
Lower \space LoA \space C.I. = Lower \space LoA - LME
\]</span></p>
<p><span class="math display">\[
Upper \space LoA \space C.I. = Upper \space LoA + LME
\]</span></p>
</div>
</div>
<div class="section level3">
<h3 id="repeated-measures-agreement">Repeated Measures Agreement<a class="anchor" aria-label="anchor" href="#repeated-measures-agreement"></a>
</h3>
<p>In many cases there are multiple measurements taken within subjects
when comparing two measurements tools. In some cases the true underlying
value will not be expected to vary (i.e.,
<code>data_type = "reps"</code>), or multiple measurements may be taken
within an individual <em>and</em> these values are expected to vary
(i.e., <code>data_type = "nest"</code>).</p>
</div>
<div class="section level3">
<h3 id="replicates">Replicates<a class="anchor" aria-label="anchor" href="#replicates"></a>
</h3>
<p>This limit of agreement type is for cases where the underlying values
do <em>not</em> vary within subjects. This can be considered cases where
replicate measure may be taken. For example, a researcher may want to
compare the performance of two ELISA assays where measurements are taken
in duplicate/triplicate.</p>
<p>So, you will have to provide the data frame object with the
<code>data</code> argument and the names of the columns containing the
first (<code>x</code> argument) and second (<code>y</code> argument)
must then be provided. An additional column indicating the subject
identifier (<code>id</code>) must also be provided. Again, if there is a
hypothesized agreement limit then this could be provided with the
<code>delta</code> argument.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a2</span> <span class="op">=</span> <span class="fu"><a href="../reference/agreement_limit.html">agreement_limit</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                id <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                data <span class="op">=</span> <span class="va">reps</span>,</span>
<span>                data_type <span class="op">=</span> <span class="st">"reps"</span>,</span>
<span>                agree.level <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a2</span></span>
<span><span class="co">#&gt; MOVER Limits of Agreement (LoA)</span></span>
<span><span class="co">#&gt; 80% LoA @ 5% Alpha-Level</span></span>
<span><span class="co">#&gt; Data with Replicates</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    Bias           Bias CI Lower LoA Upper LoA           LoA CI</span></span>
<span><span class="co">#&gt;  0.7152 [-1.5287, 2.9591]    -1.212     2.642 [-4.797, 6.2274]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SD of Differences = 1.5036</span></span></code></pre></div>
<div class="section level4">
<h4 id="calculative-steps">Calculative Steps<a class="anchor" aria-label="anchor" href="#calculative-steps"></a>
</h4>
<ol style="list-style-type: decimal">
<li>Compute mean and variance</li>
</ol>
<p><span class="math display">\[
\bar d_i = \Sigma_{j=1}^{n_i} \frac{d_{ij}}{n_i}
\]</span> <span class="math display">\[
\bar d = \Sigma^{n}_{i=1} \frac{d_i}{n}
\]</span></p>
<p><span class="math display">\[
s_i^2 = \Sigma_{j=1}^{n_i} \frac{(d_{ij} - \bar d_i)^2}{n_i-1}
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Compute pooled estimate of within subject error</li>
</ol>
<p><span class="math display">\[
s_{dw}^2 = \Sigma_{i=1}^{n} [\frac{n_i-1}{N-n} \cdot s_i^2]
\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Compute pooled estimate of between subject error</li>
</ol>
<p><span class="math display">\[
s^2_b = \Sigma_{i=1}^n \frac{ (\bar d_i - \bar d)^2}{n-1}
\]</span></p>
<ol start="4" style="list-style-type: decimal">
<li>Compute the harmonic mean of the replicate size</li>
</ol>
<p><span class="math display">\[
m_h = \frac{n}{\Sigma_{i=1}^n m_i^{-1}}
\]</span></p>
<ol start="5" style="list-style-type: decimal">
<li>Compute SD of the difference</li>
</ol>
<p><span class="math display">\[
s_d^2 = s^2_b + (1+m_h^{-1}) \cdot s_{dw}^2
\]</span></p>
<ol start="6" style="list-style-type: decimal">
<li>Calculate LME</li>
</ol>
<p><strong>MOVER Method</strong></p>
<p><span class="math display">\[
u = s_d^2 + \sqrt{[s_d^2 \cdot (1 - \frac{n-1}{\chi^2_{(1-\alpha,
n-1)}})]^2+[(1-m_h^{-1}) \cdot (1- \frac{N-n}{\chi^2_{(1-\alpha,
N-n)}})]^2}
\]</span></p>
<p><span class="math display">\[
LME = \sqrt{\frac{z_{\alpha} \cdot s_d^2}{n} + z_{\beta/2}^2 \cdot
(\sqrt{u}-\sqrt{s^2_d} )^2}
\]</span></p>
<p><strong>Bland-Atlman Method</strong></p>
<p>$$ S_{LoA}^2 = + ( + (1-)^2 + (1-)^2 )</p>
<p>$$</p>
<p><span class="math display">\[
LME = z_{1-\alpha} \cdot S_{LoA}
\]</span></p>
<ol start="7" style="list-style-type: decimal">
<li>Calculate LoA</li>
</ol>
<p><span class="math display">\[
LoA_{lower} = \bar d - z_{\beta/2} \cdot s_d
\]</span></p>
<p><span class="math display">\[
LoA_{upper} = \bar d + z_{\beta/2} \cdot s_d
\]</span></p>
<ol start="8" style="list-style-type: decimal">
<li>Calculate LoA CI</li>
</ol>
<p><span class="math display">\[
Lower \space CI = LoA_{lower} - LME
\]</span></p>
<p><span class="math display">\[
Upper \space CI = LoA_{upper} + LME
\]</span></p>
</div>
</div>
<div class="section level3">
<h3 id="nested">Nested<a class="anchor" aria-label="anchor" href="#nested"></a>
</h3>
<p>This is for cases where the underlying values may vary within
subjects. This can be considered cases where there are distinct pairs of
data wherein data is collected in different times/conditions within each
subject. An example would be measuring blood pressure on two different
devices on many people at different time points/days. The method
utilized in <code>agreement_limit</code> is similar to, but not the
exact same as those described by <span class="citation">Zou (<a href="#ref-zou2011" role="doc-biblioref">2011</a>)</span>. However, the
results should be approximately the same as <code>agree_nest</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a3</span> <span class="op">=</span> <span class="fu"><a href="../reference/agreement_limit.html">agreement_limit</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                id <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                data <span class="op">=</span> <span class="va">reps</span>,</span>
<span>                data_type <span class="op">=</span> <span class="st">"nest"</span>,</span>
<span>                loa_calc <span class="op">=</span> <span class="st">"mover"</span>,</span>
<span>                agree.level <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span></span>
<span><span class="va">a3</span></span>
<span><span class="co">#&gt; MOVER Limits of Agreement (LoA)</span></span>
<span><span class="co">#&gt; 95% LoA @ 5% Alpha-Level</span></span>
<span><span class="co">#&gt; Nested Data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    Bias           Bias CI Lower LoA Upper LoA            LoA CI</span></span>
<span><span class="co">#&gt;  0.7046 [-1.5572, 2.9664]    -2.153     3.562 [-7.4979, 8.9071]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SD of Differences = 1.4581</span></span></code></pre></div>
<div class="section level4">
<h4 id="calculation-steps-1">Calculation Steps<a class="anchor" aria-label="anchor" href="#calculation-steps-1"></a>
</h4>
<ol style="list-style-type: decimal">
<li>Model</li>
</ol>
<p>A linear mixed model (detailed below) is fit to estimate the bias
(mean difference) and variance components (within and between subject
variance).</p>
<p><span class="math display">\[
\begin{aligned}
  \operatorname{difference}_{i}  &amp;\sim N \left(\alpha_{j[i]},
\sigma^2 \right) \\
    \alpha_{j}  &amp;\sim N \left(\mu_{\alpha_{j}},
\sigma^2_{\alpha_{j}} \right)
    \text{, for subject j = 1,} \dots \text{,J}
\end{aligned}
\]</span> 2. Extract Components</p>
<p>The two variance components, (<span class="math inline">\(s_b^2\)</span> and <span class="math inline">\(s_w^2\)</span> for <span class="math inline">\(\sigma^2\)</span> and <span class="math inline">\(\sigma_{\alpha_j}^2\)</span>), are estimated from
the model. The sum of both (<span class="math inline">\(s_{total}^2\)</span>) is the total variance, and
grand intercept represents the bias (mean difference, <span class="math inline">\(\bar d\)</span>).</p>
<p>The harmonic mean is also calculated.</p>
<p><span class="math display">\[
m_h = \frac{n}{\Sigma_{i=1}^n m_i^{-1}}
\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Compute LME</li>
</ol>
<p><strong>MOVER Method</strong></p>
<p><span class="math display">\[
u_1 =   (s_b^2 \cdot ((n-1)/(\chi^2_{\alpha,n-1})-1))^2
\]</span></p>
<p><span class="math display">\[
u_2 = ((1-1/m_h) \cdot s_w^2 \cdot ((N-n)/( \chi^2_{\alpha,N-n} -1))^2
\]</span></p>
<p><span class="math display">\[
u = s_{total}^2 + \sqrt{u_1 + u_2}
\]</span></p>
<p><span class="math display">\[
LME = \sqrt{\frac{z^2_{\alpha} \cdot s_d^2}{n} + z^2_{\beta/2}
\cdot(\sqrt{u} - \sqrt{s^2_d})^2}
\]</span></p>
<p><strong>Bland-Altman Method</strong></p>
<p><span class="math display">\[
S_{LoA} = \frac{s_b^2}{n} + z_{agree}^2 / (2 \cdot s_{total}^2) \cdot
((s_b^2)^2/(n-1) + (1 - 1/m_h)^2 \cdot (s_{w}^2)^2/(N-n))
\]</span> <span class="math display">\[
LME =
\]</span></p>
<ol start="4" style="list-style-type: decimal">
<li>Calculate LoA</li>
</ol>
<p><span class="math display">\[
LoA_{lower} = \bar d - z_{\beta/2} \cdot s_d
\]</span></p>
<p><span class="math display">\[
LoA_{upper} = \bar d + z_{\beta/2} \cdot s_d
\]</span></p>
<ol start="5" style="list-style-type: decimal">
<li>Calculate LoA CI</li>
</ol>
<p><span class="math display">\[
Lower \space CI = LoA_{lower} - LME
\]</span></p>
<p><span class="math display">\[
Upper \space CI = LoA_{upper} + LME
\]</span></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="how-to-test-a-hypothesis">How to Test a Hypothesis<a class="anchor" aria-label="anchor" href="#how-to-test-a-hypothesis"></a>
</h2>
<p>Unlike the “test” functions, <code>agreement_limits</code> and
<code>tolerance_limits</code> do not test a hypothesis agreement, but
only estimate the limits. It is up to the user to determine if the
limits are within a maximal allowable difference. However, the results a
maximal allowable difference can be visualized against the
tolerance/agreement limits using the <code>delta</code> argument for the
<code>plot</code> method.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res1</span> <span class="op">=</span> <span class="fu"><a href="../reference/tolerance_limit.html">tolerance_limit</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">temps</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"trec_pre"</span>, <span class="co"># First measure</span></span>
<span>  y <span class="op">=</span> <span class="st">"teso_pre"</span>, <span class="co"># Second measure</span></span>
<span>  id <span class="op">=</span> <span class="st">"id"</span>, <span class="co"># Subject ID</span></span>
<span>  condition <span class="op">=</span> <span class="st">"tod"</span>, <span class="co"># Identify condition that may affect differences</span></span>
<span>  cor_type <span class="op">=</span> <span class="st">"sym"</span> <span class="co"># Set correlation structure as Compound Symmetry</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res1</span>, delta <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span> <span class="co"># Set maximal allowable difference to .25 units</span></span></code></pre></div>
<p><img src="agreement_analysis_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="checking-assumptions">Checking Assumptions<a class="anchor" aria-label="anchor" href="#checking-assumptions"></a>
</h2>
<p>The assumptions of normality, heteroscedasticity, and proportional
bias can all be checked using the <code>check</code> method for either
agreement or tolerance limits.</p>
<p>The function will provide 3 plots: Q-Q normality plot, standardized
residuals plot, and residuals plot.</p>
<p>All 3 plots will have a statistical test in the bottom right corner<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>. The
Shapiro-Wilk test is included for the normality plot, the Bagan-Preusch
test for heterogeneity, and the test for linear slope on the residuals
plot. Please note that there is no formal test of proportional bias for
the tolerance limits, but a plot is still included for visual
checks.</p>
<div class="section level3">
<h3 id="an-example">An Example<a class="anchor" aria-label="anchor" href="#an-example"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_agree</span> <span class="op">=</span> <span class="fu"><a href="../reference/agreement_limit.html">agreement_limit</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                           y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                           data <span class="op">=</span> <span class="va">reps</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/simple_agree-methods.html">check</a></span><span class="op">(</span><span class="va">test_agree</span><span class="op">)</span></span></code></pre></div>
<p><img src="agreement_analysis_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">test_tol</span> <span class="op">=</span> <span class="fu"><a href="../reference/tolerance_limit.html">tolerance_limit</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                           y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                           data <span class="op">=</span> <span class="va">reps</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/simple_agree-methods.html">check</a></span><span class="op">(</span><span class="va">test_tol</span><span class="op">)</span></span></code></pre></div>
<p><img src="agreement_analysis_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="proportional-bias">Proportional Bias<a class="anchor" aria-label="anchor" href="#proportional-bias"></a>
</h2>
<p>As the check plots for <code>a1</code> show, proportional bias can
sometimes occur. In these cases <span class="citation">Bland and Altman
(<a href="#ref-bland1999" role="doc-biblioref">1999</a>)</span>
recommended adjusting the bias and LoA for the proportional bias. This
is simply done by include a slope for the average of both measurements
(i.e, using an intercept + slope model rather than intercept only
model).</p>
<p>For either <code>agreement_limit</code> or
<code>tolerance_limit</code> functions, this can be accomplished with
the <code>prop_bias</code> argument. When this is set to TRUE, then the
proportional bias adjusted model is utilized. However, you should be
careful with interpreting the hypothesis tests in these cases because
the results are likely bogus for the extreme ends of the measurement. In
any case, plots and checks of the data should always be inspected.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">test_tol</span> <span class="op">=</span> <span class="fu"><a href="../reference/tolerance_limit.html">tolerance_limit</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                           y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                           data <span class="op">=</span> <span class="va">reps</span>,</span>
<span>                           prop_bias <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">test_tol</span><span class="op">)</span></span>
<span><span class="co">#&gt; Agreement between Measures (Difference: x-y)</span></span>
<span><span class="co">#&gt; 95% Prediction Interval with 95% Tolerance Limits</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Average of Both Methods    Bias           Bias CI Prediction Interval</span></span>
<span><span class="co">#&gt;                    3.905 -0.4670 [-1.3842, 0.4502]   [-2.8876, 1.9537]</span></span>
<span><span class="co">#&gt;                    5.240  0.3513 [-0.1816, 0.8842]    [-1.9513, 2.654]</span></span>
<span><span class="co">#&gt;                    7.395  1.6723  [0.5218, 2.8228]    [-0.846, 4.1906]</span></span>
<span><span class="co">#&gt;   Tolerance Limits</span></span>
<span><span class="co">#&gt;  [-3.6396, 2.7057]</span></span>
<span><span class="co">#&gt;  [-2.6667, 3.3694]</span></span>
<span><span class="co">#&gt;  [-1.6284, 4.9729]</span></span>
<span></span>
<span><span class="co"># See effect of proportional bias on limits</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_tol</span><span class="op">)</span></span></code></pre></div>
<p><img src="agreement_analysis_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Confirm its effects in proportional bias check plot (should be horizontal now)</span></span>
<span><span class="fu"><a href="../reference/simple_agree-methods.html">check</a></span><span class="op">(</span><span class="va">test_tol</span><span class="op">)</span></span></code></pre></div>
<p><img src="agreement_analysis_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="visualizing-big-data">Visualizing “Big” Data<a class="anchor" aria-label="anchor" href="#visualizing-big-data"></a>
</h2>
<p>Sometimes there may be a lot of data and individual points of data on
mean difference visualization may be less than ideal. In order to change
the plots from showing the individual data points we can modify the
<code>geom</code> argument.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">81346</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">750</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">diff</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">750</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="va">x</span> <span class="op">+</span> <span class="va">diff</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,</span>
<span>                y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a1</span> <span class="op">=</span> <span class="fu"><a href="../reference/agreement_limit.html">agreement_limit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>,</span>
<span>                     x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                     y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                     agree.level <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a1</span>,</span>
<span>     geom <span class="op">=</span> <span class="st">"geom_point"</span><span class="op">)</span></span></code></pre></div>
<p><img src="agreement_analysis_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a1</span>,</span>
<span>     geom <span class="op">=</span> <span class="st">"geom_bin2d"</span><span class="op">)</span></span></code></pre></div>
<p><img src="agreement_analysis_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a1</span>,</span>
<span>     geom <span class="op">=</span> <span class="st">"geom_density_2d"</span><span class="op">)</span></span></code></pre></div>
<p><img src="agreement_analysis_files/figure-html/unnamed-chunk-10-3.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a1</span>,</span>
<span>     geom <span class="op">=</span> <span class="st">"geom_density_2d_filled"</span><span class="op">)</span></span></code></pre></div>
<p><img src="agreement_analysis_files/figure-html/unnamed-chunk-10-4.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a1</span>,</span>
<span>     geom <span class="op">=</span> <span class="st">"stat_density_2d"</span><span class="op">)</span></span></code></pre></div>
<p><img src="agreement_analysis_files/figure-html/unnamed-chunk-10-5.png" width="700"></p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bland1986" class="csl-entry">
Bland, J Martin, and Douglas G Altman. 1986. <span>“Statistical Methods
for Assessing Agreement Between Two Methods of Clinical
Measurement.”</span> <em>The Lancet</em> 327 (8476): 307–10. <a href="https://doi.org/10.1016/s0140-6736(86)90837-8" class="external-link">https://doi.org/10.1016/s0140-6736(86)90837-8</a>.
</div>
<div id="ref-bland1999" class="csl-entry">
———. 1999. <span>“Measuring Agreement in Method Comparison
Studies.”</span> <em>Statistical Methods in Medical Research</em> 8 (2):
135–60. <a href="https://doi.org/10.1177/096228029900800204" class="external-link">https://doi.org/10.1177/096228029900800204</a>.
</div>
<div id="ref-donner2012closed" class="csl-entry">
Donner, Allan, and GY Zou. 2012. <span>“Closed-Form Confidence Intervals
for Functions of the Normal Mean and Standard Deviation.”</span>
<em>Statistical Methods in Medical Research</em> 21 (4): 347–59.
</div>
<div id="ref-francq2020tolerate" class="csl-entry">
Francq, Bernard G, Marion Berger, and Charles Boachie. 2020. <span>“To
Tolerate or to Agree: A Tutorial on Tolerance Intervals in Method
Comparison Studies with BivRegBLS r Package.”</span> <em>Statistics in
Medicine</em> 39 (28): 4334–49.
</div>
<div id="ref-lmertest" class="csl-entry">
Kuznetsova, Alexandra, Per B Brockhoff, and Rune HB Christensen. 2017.
<span>“lmerTest Package: Tests in Linear Mixed Effects Models.”</span>
<em>Journal of Statistical Software</em> 82: 1–26.
</div>
<div id="ref-satterthwaite1946" class="csl-entry">
Satterthwaite, Franklin E. 1946. <span>“An Approximate Distribution of
Estimates of Variance Components.”</span> <em>Biometrics Bulletin</em> 2
(6): 110–14.
</div>
<div id="ref-zou2011" class="csl-entry">
Zou, GY. 2011. <span>“Confidence Interval Estimation for the
Bland<span></span>altman Limits of Agreement with Multiple Observations
Per Individual.”</span> <em>Statistical Methods in Medical Research</em>
22 (6): 630–42. <a href="https://doi.org/10.1177/0962280211402548" class="external-link">https://doi.org/10.1177/0962280211402548</a>.
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>Pinheiro, J.C., and Bates, D.M. (2000) “Mixed-Effects
Models in S and S-PLUS”, Springer, esp. pp. 100, 461.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>No test is included for proportional bias for
<code>tolerance_limit</code> results at this time.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Aaron Caldwell.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
