<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Power Calculation for Exact Agreement/Tolerance Test — power_agreement_exact • SimplyAgree</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Power Calculation for Exact Agreement/Tolerance Test — power_agreement_exact"><meta name="description" content="
Computes sample size, power, or other parameters for the exact method of
assessing agreement between two measurement methods, as described in
Shieh (2019). This method tests whether the central portion of paired
differences falls within specified bounds. This roughly equates to the power for tolerance limits."><meta property="og:description" content="
Computes sample size, power, or other parameters for the exact method of
assessing agreement between two measurement methods, as described in
Shieh (2019). This method tests whether the central portion of paired
differences falls within specified bounds. This roughly equates to the power for tolerance limits."><meta property="og:image" content="https://aaroncaldwell.us/SimplyAgree/images/sticker.png"><meta property="og:image:alt" content="SimplyAgree logo"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SimplyAgree</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/agree_tests.html">Agreement Tests</a></li>
    <li><a class="dropdown-item" href="../articles/agreement_analysis.html">Agreement &amp; Tolerance Limits</a></li>
    <li><a class="dropdown-item" href="../articles/Deming.html">Error-in-Variables Regression</a></li>
    <li><a class="dropdown-item" href="../articles/power_sample_size_vignette.html">Power Analysis and Sample Size Determination for Agreement Studies</a></li>
    <li><a class="dropdown-item" href="../articles/reanalysis.html">Re-analysis of an Agreement Study</a></li>
    <li><a class="dropdown-item" href="../articles/reliability_analysis.html">Reliability Analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/arcaldwell49/SimplyAgree/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Power Calculation for Exact Agreement/Tolerance Test</h1>
      <small class="dont-index">Source: <a href="https://github.com/arcaldwell49/SimplyAgree/blob/HEAD/R/power_exact_agreement.R" class="external-link"><code>R/power_exact_agreement.R</code></a></small>
      <div class="d-none name"><code>power_agreement_exact.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing" class="external-link"><img src="figures/lifecycle-maturing.svg" alt="[Maturing]"></a></p>
<p>Computes sample size, power, or other parameters for the exact method of
assessing agreement between two measurement methods, as described in
Shieh (2019). This method tests whether the central portion of paired
differences falls within specified bounds. This <em>roughly</em> equates to the power for tolerance limits.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">power_agreement_exact</span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  delta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mu <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sigma <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p0_star <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  power <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Number of subject pairs (sample size)</p></dd>


<dt id="arg-delta">delta<a class="anchor" aria-label="anchor" href="#arg-delta"></a></dt>
<dd><p>Maximum allowable difference bound (half-width of tolerance interval)</p></dd>


<dt id="arg-mu">mu<a class="anchor" aria-label="anchor" href="#arg-mu"></a></dt>
<dd><p>Mean of paired differences</p></dd>


<dt id="arg-sigma">sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>Standard deviation of paired differences</p></dd>


<dt id="arg-p-star">p0_star<a class="anchor" aria-label="anchor" href="#arg-p-star"></a></dt>
<dd><p>The coverage proportion (content) of the tolerance interval. Central proportion under null hypothesis (default = 0.95)</p></dd>


<dt id="arg-power">power<a class="anchor" aria-label="anchor" href="#arg-power"></a></dt>
<dd><p>Target power (probability of rejecting false null)</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Significance level (Type I error rate, default = 0.05, Confidence level = 1-alpha)</p></dd>


<dt id="arg-max-iter">max_iter<a class="anchor" aria-label="anchor" href="#arg-max-iter"></a></dt>
<dd><p>Maximum iterations for gamma computation (default = 1000)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class "power.htest", a list with components:</p>
<dl><dt>n</dt>
<dd><p>Sample size</p></dd>

<dt>delta</dt>
<dd><p>c</p></dd>

<dt>mu</dt>
<dd><p>Mean of differences</p></dd>

<dt>sigma</dt>
<dd><p>Standard deviation of differences</p></dd>

<dt>p0_star</dt>
<dd><p>Central proportion (null hypothesis)</p></dd>

<dt>p1_star</dt>
<dd><p>Central proportion (alternative hypothesis)</p></dd>

<dt>alpha</dt>
<dd><p>Significance level</p></dd>

<dt>power</dt>
<dd><p>Power of the test</p></dd>

<dt>critical_value</dt>
<dd><p>Critical value for test statistic</p></dd>

<dt>method</dt>
<dd><p>Description of the method</p></dd>

<dt>note</dt>
<dd><p>Additional notes</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function implements the exact agreement test procedure of Shieh (2019)
for method comparison studies. The test evaluates whether the central
proportion of the distribution of paired differences lies within the
interval [-delta, delta].</p>
<p>The null hypothesis is: H0: theta_(1-p) &lt;= -delta or delta &lt;= theta_p
The alternative is: H1: -delta &lt; theta_(1-p) and theta_p &lt; delta</p>
<p>where p = (1 + p0_star)/2, and theta_p represents the 100p-th percentile
of the paired differences.</p>
<p>Specify three of: n, delta, power, and sigma. The fourth will be calculated.
If mu is not specified, it defaults to 0.</p>
<p>Tolerance Interval Interpretation:</p>
<p>The parameter <code>p0_star</code> represents the tolerance coverage proportion,
i.e., the proportion of the population that must fall within the specified
bounds [-delta, delta] under the null hypothesis. This is conceptually
related to tolerance intervals, but formulated as a
hypothesis test rather than an estimation problem.</p>
<p>Note: This differs from Bland-Altman's "95% limits of agreement," which
are confidence intervals for the 2.5th and 97.5th percentiles, <em>not</em>
tolerance intervals.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Shieh, G. (2019). Assessing Agreement Between Two Methods of Quantitative
Measurements: Exact Test Procedure and Sample Size Calculation.
Statistics in Biopharmaceutical Research, 12(3), 352-359.
https://doi.org/10.1080/19466315.2019.1677495</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1: Find required sample size</span></span></span>
<span class="r-in"><span><span class="fu">power_agreement_exact</span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">7</span>, mu <span class="op">=</span> <span class="fl">0.5</span>, sigma <span class="op">=</span> <span class="fl">2.5</span>,</span></span>
<span class="r-in"><span>                      p0_star <span class="op">=</span> <span class="fl">0.95</span>, power <span class="op">=</span> <span class="fl">0.80</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Maximum iterations reached in gamma computation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Power for Exact Method for Assessing Agreement Between Two Methods </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               n = 34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           delta = 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              mu = 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           sigma = 2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         p0_star = 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         p1_star = 0.9939889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           alpha = 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           power = 0.8018321</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  critical_value = 13.57044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOTE: H0: Central 95% of differences not within [-delta, delta]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      H1: Central 99.4% of differences within [-delta, delta] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n is number pairs. Two measurements per unit; one for each method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Calculate power for given sample size</span></span></span>
<span class="r-in"><span><span class="fu">power_agreement_exact</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">15</span>, delta <span class="op">=</span> <span class="fl">0.1</span>, mu <span class="op">=</span> <span class="fl">0.011</span>,</span></span>
<span class="r-in"><span>                      sigma <span class="op">=</span> <span class="fl">0.044</span>, p0_star <span class="op">=</span> <span class="fl">0.80</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Power for Exact Method for Assessing Agreement Between Two Methods </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               n = 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           delta = 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              mu = 0.011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           sigma = 0.044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         p0_star = 0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         p1_star = 0.9726269</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           alpha = 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           power = 0.8315332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  critical_value = 6.391135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOTE: H0: Central 80% of differences not within [-delta, delta]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      H1: Central 97.3% of differences within [-delta, delta] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n is number pairs. Two measurements per unit; one for each method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: Find required delta for given power and sample size</span></span></span>
<span class="r-in"><span><span class="fu">power_agreement_exact</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, mu <span class="op">=</span> <span class="fl">0</span>, sigma <span class="op">=</span> <span class="fl">2.5</span>,</span></span>
<span class="r-in"><span>                      p0_star <span class="op">=</span> <span class="fl">0.95</span>, power <span class="op">=</span> <span class="fl">0.90</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Power for Exact Method for Assessing Agreement Between Two Methods </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               n = 50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           delta = 6.65619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              mu = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           sigma = 2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         p0_star = 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         p1_star = 0.9922432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           alpha = 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           power = 0.9000104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  critical_value = 15.89319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOTE: H0: Central 95% of differences not within [-delta, delta]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      H1: Central 99.2% of differences within [-delta, delta] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n is number pairs. Two measurements per unit; one for each method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aaron Caldwell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

